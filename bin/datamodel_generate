#!/usr/bin/env python3
# encoding: utf-8
#
# @Author: Joel Brownstein <joelbrownstein@sdss.org>
# @Date: Nov 9, 2020
# @Filename: datamodel_generate
# @License: BSD 3-Clause
# @Copyright: SDSS.

from datamodel.command import Command
from datamodel.generate import Generate


command = Command(name="datamodel_generate")
generate = Generate(options=command.options)
# creates the output product directories in data/
generate.set_directory()
# constructs a real filepath
generate.set_file()
# build and writes the product stubs
generate.set_stub(skip_git=True)

"""
usage via commandline:
datamodel_generate -t sdss5 -e APOGEE_REDUX -l {apred}/summary/allStar-{apred}-{telescope}.fits -v
datamodel_generate -t sdss5 -e APOGEE_REDUX -l {apred}/visit/{telescope}/{field}/{plate}/{mjd}/apVisit-{apred}-{telescope}-{plate}-{mjd}-{fiber:0\>3}.fits -k apred=daily telescope=apo25m field=AQW_114.81_+29.83 plate=15016 mjd=59146 fiber=275 -v
datamodel_generate -t sdss5 -e APOGEE_REDUX -l {apred}/{apstar}/{telescope}/{healpixgrp}/{healpix}/apStar-{apred}-{telescope}-{obj}.fits -k apred=daily telescope=apo25m apstar=stars healpixgrp=48 healpix=48545 obj=2M07333300+3025567 -v

usage via python:
from datamodel.generate import Generate
generate = Generate(tree_ver = 'sdss5', env_label = 'APOGEE_REDUX', location = 'daily/summary/allStar-daily-apo25m.fits',  verbose = True)
generate.set_directory()
generate.set_file()
generate.set_stub()

datamodel_generate -t sdss5 -f silo_eboss_detections -p EBOSS_SANDBOX/silo/{run2d}/{run1d}/{silo_ver}/silo_eboss_detections-{silo_ver}.fits -k run2d=v5_13_0  run1d=v5_13_0 silo_ver=1.0.1 -v

from datamodel.generate import Generate
generate = Generate(tree_ver = 'sdss5', file_spec = 'silo_eboss_detections', path = 'EBOSS_SANDBOX/silo/{run2d}/{run1d}/{silo_ver}/silo_eboss_detections-{silo_ver}.fits', keywords = ['run2d=v5_13_0', 'run1d=v5_13_0', 'silo_ver=1.0.1'], verbose = True)
generate.set_directory()
generate.set_file()
generate.set_stub()

datamodel_generate -t sdss5 -f spAll -p BOSS_SPECTRO_REDUX/{run2d}/spAll-{run2d}.fits -k run2d=master -v
datamodel_generate -f apVisit -p APOGEE_REDUX/{apred}/visit/{telescope}/{field}/{plate}/{mjd}/apVisit-{apred}-{telescope}-{plate}-{mjd}-{fiber}.fits -k apred=daily telescope=apo25m field=YSO_043 plate=15119 mjd=50212 fiber=002 -v

datamodel_generate -f summary_classify_apstar -p MWM_ASTRA/{astra_vers}/summary-classify-apstar.fits -k astra_vers=0.1.11 -v

"""
