general:
  name: spZbest_coadd
  short: BOSS best spectroscopic classifications and redshifts for custom coadd spectra
  description: The spZbest files contain the spectroscopic classifications and redshifts
    from the spectro-1d step of the BOSS idlspec1d pipeline for the custom coadd spectra
  datatype: FITS
  filesize: 15 MB
  releases:
  - WORK
  environments:
  - BOSS_SPECTRO_REDUX
  surveys:
  - BHM
  naming_convention: $BOSS_SPECTRO_REDUX/[RUN2D]/[COADD]/[RUN1D]/spZbest-[COADD]-[MJD].fits
  generated_by: idlspec2d
  design: false
  vac: false
  recommended_science_product: false
changelog:
  description: Describes changes to the datamodel product and/or file structure from
    one release to another
  releases: {}
releases:
  WORK:
    template: $BOSS_SPECTRO_REDUX/[RUN2D]/[COADD]/[RUN1D]/spZbest-[COADD]-[MJD].fits
    example: v6_1_3/allepoch/v6_1_3/spZbest-allepoch-60000.fits
    location: '{run2d}/{coadd}/{run1d}/spZbest-{coadd}-{mjd}.fits'
    environment: BOSS_SPECTRO_REDUX
    access:
      in_sdss_access: true
      path_name: spZbest_coadd
      path_template: $BOSS_SPECTRO_REDUX/{run2d}/{coadd}/epoch/{run1d}/spZbest-{coadd}-{mjd}.fits
      path_kwargs:
      - coadd
      - run2d
      - mjd
      - run1d
      access_string: spZbest_coadd = $BOSS_SPECTRO_REDUX/{run2d}/{coadd}/{run1d}/spZbest-{coadd}-{mjd}.fits
    survey: BHM
    hdus:
      hdu0:
        name: PRIMARY
        description: ''
        is_image: true
        size: 0 bytes
        header:
        - key: SIMPLE
          value: true
          comment: Primary Header created by MWRFITS v1.13
        - key: BITPIX
          value: 16
          comment: ''
        - key: NAXIS
          value: 0
          comment: ''
        - key: EXTEND
          value: true
          comment: Extensions may be present
        - key: COEFF0
          value: 3.5523
          comment: Central wavelength (log10) of first pixel
        - key: COEFF1
          value: 0.0001
          comment: Log10 dispersion per pixel
        - key: CRVAL1
          value: 3.5523
          comment: Central wavelength (log10) of first pixel
        - key: CD1_1
          value: 0.0001
          comment: Log10 dispersion per pixel
        - key: CRPIX1
          value: 1
          comment: Starting pixel (1-indexed)
        - key: CTYPE1
          value: LINEAR
          comment: ''
        - key: MJD
          value: 60000
          comment: Modified Julian Date
        - key: RUNMJD
          value: '60407'
          comment: Modified Julian Date of RUN
        - key: RUN2D
          value: v6_1_3
          comment: IDLSpec2D Run2d
        - key: RUN1D
          value: v6_1_3
          comment: Spectro-1D reduction name
        - key: VERS1D
          value: v6_1_3
          comment: Version of idlspec2d for 1D reduction
        - key: TILEID
          value: ''
          comment: Tile ID for SDSS BOSS plates (-1 for SDSS)
        - key: MOON_FRA
          value: 0.270368403284
          comment: Moon Phase
        - key: SPEC1_G
          value: 6.62995
          comment: (S/N)^2 for spec  1 at mag 21.20
        - key: SN2EXT1G
          value: 6.62995
          comment: Extinction corrected (S/N)^2
        - key: SPEC1_R
          value: 21.791
          comment: (S/N)^2 for spec  1 at mag 20.20
        - key: SN2EXT1R
          value: 21.791
          comment: Extinction corrected (S/N)^2
        - key: SPEC1_I
          value: 16.2032
          comment: (S/N)^2 for spec  1 at mag 20.20
        - key: SN2EXT1I
          value: 16.2032
          comment: Extinction corrected (S/N)^2
        - key: NGAL
          value: 359
          comment: Number of (good) main galaxies
        - key: GOFFGAL
          value: 0.0602238311768
          comment: Spectrophoto offset for main galaxies in G-band
        - key: GRMSGAL
          value: 0.358758642181
          comment: Spectrophoto RMS for main galaxies in G-band
        - key: ROFFGAL
          value: 0.0581752210299
          comment: Spectrophoto offset for main galaxies in R-band
        - key: RRMSGAL
          value: 0.339271579636
          comment: Spectrophoto RMS for main galaxies in R-band
        - key: IOFFGAL
          value: 0.10673924994
          comment: Spectrophoto offset for main galaxies in I-band
        - key: IRMSGAL
          value: 0.382877112938
          comment: Spectrophoto RMS for main galaxies in I-band
        - key: GROFFGAL
          value: 0.00221052551269
          comment: Spectrophoto offset for main galaxies in (GR)
        - key: GRRMSGAL
          value: 0.230922157945
          comment: Spectrophoto RMS for main galaxies in (GR)
        - key: RIOFFGAL
          value: -0.0356044439901
          comment: Spectrophoto offset for main galaxies in (RI)
        - key: RIRMSGAL
          value: 0.161101424416
          comment: Spectrophoto RMS for main galaxies in (RI)
        - key: UNAME
          value: notch283
          comment: ''
        - key: CHOP_MIN
          value: 3600.0
          comment: ''
        - key: CHOP_MAX
          value: 10400.0
          comment: ''
      hdu1:
        name: ''
        description: Object classifications and redshifts
        is_image: false
        size: 463 KB
        header:
        - key: XTENSION
          value: BINTABLE
          comment: Binary table written by MWRFITS v1.13
        - key: BITPIX
          value: 8
          comment: Required value
        - key: NAXIS
          value: 2
          comment: Required value
        - key: NAXIS1
          value: 1149
          comment: Number of bytes per row
        - key: NAXIS2
          value: 413
          comment: Number of rows
        - key: PCOUNT
          value: 0
          comment: Normally 0 (no varying arrays)
        - key: GCOUNT
          value: 1
          comment: Required value
        - key: TFIELDS
          value: 76
          comment: Number of columns in table
        - key: COMMENT
          value: ''
          comment: ''
        - key: COMMENT
          value: ' *** End of mandatory fields ***'
          comment: ''
        - key: COMMENT
          value: ''
          comment: ''
        - key: COMMENT
          value: ''
          comment: ''
        - key: COMMENT
          value: ' *** Unsigned integer column scalings *'
          comment: ''
        - key: COMMENT
          value: ''
          comment: ''
        - key: TSCAL76
          value: 1
          comment: ''
        - key: TZERO76
          value: 9223372036854775808
          comment: ''
        - key: COMMENT
          value: ''
          comment: ''
        - key: COMMENT
          value: ' *** Column formats ***'
          comment: ''
        - key: COMMENT
          value: ''
          comment: ''
        - key: COMMENT
          value: ''
          comment: ''
        - key: COMMENT
          value: ' *** Column dimensions (2 D or greater) ***'
          comment: ''
        - key: COMMENT
          value: ''
          comment: ''
        - key: TDIM26
          value: ( 10, 10)
          comment: ''
        - key: COMMENT
          value: ''
          comment: ''
        - key: COMMENT
          value: ' *** Column names ***'
          comment: ''
        - key: COMMENT
          value: ''
          comment: ''
        columns:
          FIELD:
            name: FIELD
            type: int32
            description: SDSS FieldID (plateID for plate era data)
          TILE:
            name: TILE
            type: int32
            description: Tile ID for SDSS BOSS plates (-1 for SDSS)
          MJD:
            name: MJD
            type: int32
            description: Modified Julian date of combined Spectra
          TARGET_INDEX:
            name: TARGET_INDEX
            type: int32
            description: Index of target on combined spField
          CATALOGID:
            name: CATALOGID
            type: int64
            description: SDSS-V CatalogID used in naming
          SDSS_ID:
            name: SDSS_ID
            type: int64
            description: Unified SDSS Target Identifier
          FIBERID_LIST:
            name: FIBERID_LIST
            type: char[31]
            description: List of FiberIDs contributing to Stack
          RUN2D:
            name: RUN2D
            type: char[6]
            description: Spectro-2D reduction name
          RUN1D:
            name: RUN1D
            type: char[6]
            description: Spectro-1D reduction name
          OBJTYPE:
            name: OBJTYPE
            type: char[16]
            description: Why this object was targetted. QSO=SCIENCE
          FIBER_RA:
            name: FIBER_RA
            type: float64
            unit: deg
            description: Fiber RA [J2000 for plate; at exp for FPS]
          FIBER_DEC:
            name: FIBER_DEC
            type: float64
            unit: deg
            description: Fiber DEC [J2000 for plate; at exp for FPS]
          PLUG_RA:
            name: PLUG_RA
            type: float64
            unit: deg
            description: Object RA (drilled fiber position) [J2000]
          PLUG_DEC:
            name: PLUG_DEC
            type: float64
            unit: deg
            description: Object DEC (drilled fiber position) [J2000]
          CLASS:
            name: CLASS
            type: char[6]
            description: 'Spectro classification: GALAXY, QSO, STAR'
          SUBCLASS:
            name: SUBCLASS
            type: char[21]
            description: Spectro sub-classification
          Z:
            name: Z
            type: float32
            description: Redshift; incorrect for nonzero ZWARNING flag
          Z_ERR:
            name: Z_ERR
            type: float32
            description: z error from chi^2 min; negative is invalid fit
          RCHI2:
            name: RCHI2
            type: float32
            description: Reduced chi^2 for best fit
          DOF:
            name: DOF
            type: int32
            description: Degrees of freedom for best fit
          RCHI2DIFF:
            name: RCHI2DIFF
            type: float32
            description: Diff in reduced chi^2 of 2 best solutions
          TFILE:
            name: TFILE
            type: char[24]
            description: Template file in $IDLSPEC2D_DIR/templates
          TCOLUMN:
            name: TCOLUMN
            type: int32[10]
            description: Column to use in template file (0-indexed)
          NPOLY:
            name: NPOLY
            type: int32
            description: '# of polynomial terms with TFILE'
          THETA:
            name: THETA
            type: float32[10]
            description: Eigenvalue coeff for template file + polynomial
          THETA_COVAR:
            name: THETA_COVAR
            type: float32[100]
            description: Covariance matrix for THETA
          VDISP:
            name: VDISP
            type: float32
            unit: km/s
            description: Velocity dispersion, only computed for galaxies
          VDISP_ERR:
            name: VDISP_ERR
            type: float32
            unit: km/s
            description: Error in VDISP; negative for invalid fit
          VDISPZ:
            name: VDISPZ
            type: float32
            description: Redshift for best-fit velocity dispersion
          VDISPZ_ERR:
            name: VDISPZ_ERR
            type: float32
            description: Error in VDISPZ
          VDISPCHI2:
            name: VDISPCHI2
            type: float32
            description: Chi^2 for best-fit velocity dispersion
          VDISPNPIX:
            name: VDISPNPIX
            type: float32
            description: Num of pixels overlapping VDISP fit templates
          VDISPDOF:
            name: VDISPDOF
            type: int32
            description: DOF for best-fit velocity dispersion
          WAVEMIN:
            name: WAVEMIN
            type: float32
            unit: AA
            description: Minimum observed (vacuum) wavelength for target
          WAVEMAX:
            name: WAVEMAX
            type: float32
            unit: AA
            description: Maximum observed (vacuum) wavelength for target
          WCOVERAGE:
            name: WCOVERAGE
            type: float32
            unit: log10(AA)
            description: Amount of wavelength coverage in log-10(Angs)
          ZWARNING:
            name: ZWARNING
            type: int32
            description: A flag for bad z fits in place of CLASS=UNKNOWN
          SN_MEDIAN:
            name: SN_MEDIAN
            type: float32[5]
            description: Median S/N for all good pixels in SDSS-{ugriz}
          SN_MEDIAN_ALL:
            name: SN_MEDIAN_ALL
            type: float32
            description: Median S/N for all good pixels in all filters
          CHI68P:
            name: CHI68P
            type: float32
            description: 68% of abs(chi) of synthetic to actual spectrum
          FRACNSIGMA:
            name: FRACNSIGMA
            type: float32[10]
            description: Fraction of pixels deviant by >{1-10} sigma
          FRACNSIGHI:
            name: FRACNSIGHI
            type: float32[10]
            description: Fraction of pixels high by >{1-10} sigma
          FRACNSIGLO:
            name: FRACNSIGLO
            type: float32[10]
            description: Fraction of pixels low by >{1-10} sigma
          SPECTROFLUX:
            name: SPECTROFLUX
            unit: nanomaggy
            type: float32[5]
            description: Spectrum projected onto SDSS-{ugriz} filter
          SPECTROFLUX_IVAR:
            name: SPECTROFLUX_IVAR
            unit: nanomaggy
            type: float32[5]
            description: Inverse variance of SPECTROFLUX
          SPECTROSYNFLUX:
            name: SPECTROSYNFLUX
            unit: nanomaggy
            type: float32[5]
            description: Best-fit template projected onto SDSS-{ugriz}
          SPECTROSYNFLUX_IVAR:
            name: SPECTROSYNFLUX_IVAR
            unit: nanomaggy
            type: float32[5]
            description: Inverse variance of SPECTROSYNFLUX
          SPECTROSKYFLUX:
            name: SPECTROSKYFLUX
            unit: nanomaggy
            type: float32[5]
            description: Sky spectrum projected onto SDSS-{ugriz} filter
          ANYANDMASK:
            name: ANYANDMASK
            type: int32
            description: For each bit, any pixel has bit set in ANDMASK
          ANYORMASK:
            name: ANYORMASK
            type: int32
            description: For each bit, any pixel has bit set in ORMASK
          SPEC1_G:
            name: SPEC1_G
            type: float32
            description: Fit (S/N)^2 at g=20.20 for spectrograph 1
          SPEC1_R:
            name: SPEC1_R
            type: float32
            description: Fit (S/N)^2 at r=20.25 for spectrograph 1
          SPEC1_I:
            name: SPEC1_I
            type: float32
            description: Fit (S/N)^2 at i=19.90 for spectrograph 1
          SPEC2_G:
            name: SPEC2_G
            type: float32
            description: Fit (S/N)^2 at g=20.20 for spectrograph 2
          SPEC2_R:
            name: SPEC2_R
            type: float32
            description: Fit (S/N)^2 at r=20.25 for spectrograph 2
          SPEC2_I:
            name: SPEC2_I
            type: float32
            description: Fit (S/N)^2 at i=19.90 for spectrograph 2
          ELODIE_FILENAME:
            name: ELODIE_FILENAME
            type: char[16]
            description: File name for best-fit Elodie star
          ELODIE_OBJECT:
            name: ELODIE_OBJECT
            type: char[8]
            description: Star name (mostly Henry Draper names)
          ELODIE_SPTYPE:
            name: ELODIE_SPTYPE
            type: char[12]
            description: Spectral type
          ELODIE_BV:
            name: ELODIE_BV
            type: float32
            description: (B-V) color
          ELODIE_TEFF:
            name: ELODIE_TEFF
            unit: K
            type: float32
            description: Effective temperature
          ELODIE_LOGG:
            name: ELODIE_LOGG
            unit: cm/s^2
            type: float32
            description: Log10(gravity)
          ELODIE_FEH:
            name: ELODIE_FEH
            unit: solar
            type: float32
            description: '[Fe/H]'
          ELODIE_Z:
            name: ELODIE_Z
            type: float32
            description: Redshift
          ELODIE_Z_ERR:
            name: ELODIE_Z_ERR
            type: float32
            description: Redshift error; negative for invalid fit
          ELODIE_Z_MODELERR:
            name: ELODIE_Z_MODELERR
            type: float32
            description: The standard deviation in redshift amongst the 12 best-fit
              stars
          ELODIE_RCHI2:
            name: ELODIE_RCHI2
            type: float32
            description: Reduced chi^2
          ELODIE_DOF:
            name: ELODIE_DOF
            type: int32
            description: Degrees of freedom for fit
          Z_NOQSO:
            name: Z_NOQSO
            type: float32
            description: Redshift of the best-fit non-QSO model (recommended for CMASS
              and LOZ).
          Z_ERR_NOQSO:
            name: Z_ERR_NOQSO
            type: float32
            description: Formal one-sigma error on Z_NOQSO (recommended for CMASS
              and LOZ).
          ZNUM_NOQSO:
            name: ZNUM_NOQSO
            type: int32
            description: Best fit redshift/classification index while excluding QSO
              fits; 1-indexed.
          ZWARNING_NOQSO:
            name: ZWARNING_NOQSO
            type: int32
            description: Redshift warning flag for Z_NOQSO (recommended for CMASS
              and LOZ).
          CLASS_NOQSO:
            name: CLASS_NOQSO
            type: char[6]
            description: Spectro classification of best-fit non-QSO model (recommended
              for CMASS and LOZ).
          SUBCLASS_NOQSO:
            name: SUBCLASS_NOQSO
            type: char[21]
            description: Spectro sub-classification of best-fit non-QSO model (recommended
              for CMASS and LOZ).
          RCHI2DIFF_NOQSO:
            name: RCHI2DIFF_NOQSO
            type: float32
            description: Reduced chi-squared difference to next-best non-QSO model
              (recommended for CMASS and LOZ)
          SPECOBJID:
            name: SPECOBJID
            type: int64
            description: SAS-style SPECID based upon plate, mjd, fiber, run2d
      hdu2:
        name: ''
        description: the best fit eigenspectrum for each object.
        is_image: true
        size: 7 MB
        header:
        - key: XTENSION
          value: IMAGE
          comment: Image Extension created by MWRFITS v1.13
        - key: BITPIX
          value: -32
          comment: ''
        - key: NAXIS
          value: 2
          comment: ''
        - key: NAXIS1
          value: 4648
          comment: ''
        - key: NAXIS2
          value: 413
          comment: ''
        - key: PCOUNT
          value: 0
          comment: ''
        - key: GCOUNT
          value: 1
          comment: ''
      hdu3:
        name: ''
        description: Best fit velocity dispersions for galaxy spectra
        is_image: true
        size: 7 MB
        header:
        - key: XTENSION
          value: IMAGE
          comment: Image Extension created by MWRFITS v1.13
        - key: BITPIX
          value: -32
          comment: ''
        - key: NAXIS
          value: 2
          comment: ''
        - key: NAXIS1
          value: 4648
          comment: ''
        - key: NAXIS2
          value: 413
          comment: ''
        - key: PCOUNT
          value: 0
          comment: ''
        - key: GCOUNT
          value: 1
          comment: ''
notes: |-
  None
