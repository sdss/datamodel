# Data Model: spArc


Extacted Arc Frame and wavelength solution


## Contents
- [Basic Information](#basic-information)
- [Changelog](#changelog)
- [Example HDUS List](#example-hdus-list)
- [Notes](#notes)

---

## Basic Information
This file contains information about flux density, wavelength solution, fibermask and line width obtained from extracted arc calibration frames.

### Naming Convention
$BOSS_SPECTRO_REDUX/[RUN2D]/[FIELD]/spArc-[BR][ID]-[FRAME].fits.gz

### Releases
WORK

### Enviroments
BOSS_SPECTRO_REDUX

### Approximate Size
231 KB

### File Type
FITS

### Generated by Product
idlspec2d - spCalib.pro

### Is a VAC
False

### HDUS List for release WORK
  - [HDU0: flux](#hdu0-flux)
  - [HDU1: lambda](#hdu1-lambda)
  - [HDU2: wset](#hdu2-wset)
  - [HDU3: fibermask](#hdu3-fibermask)
  - [HDU4: dispset](#hdu4-dispset)
  - [HDU5: reslset](#hdu5-reslset)
  - [HDU6: rejline](#hdu6-rejline)
  - [HDU7: XDIF_TSET](#hdu7-xdif_tset)

---

## Changelog
Describes changes to the datamodel product and/or file structure from one release to another

---
## Example HDUS List

### HDU0: flux
The data attribute of Primary HDU stores the extracted flux for the entire image.

#### HDU Type: IMAGE
#### HDU Size:  0 bytes

##### Header Table Caption for HDU0
Key | Value | Comment | |
| --- | --- | --- | --- |
| SIMPLE | True | Written by IDL:  Wed Apr  3 01:57:45 2024 |
| BITPIX | 8 | Number of bits per data pixel |
| NAXIS | 0 | Number of data axes |
| NAXIS1 | 4096 |  |
| NAXIS2 | 4112 |  |
| EXTEND | True |  |
|  |  |  |
|  | INSTRUMENT INFO |  |
| TELESCOP | SDSS 2.5-M | Telescope |
| OBSERVAT | APO | Observatory |
| SPEC |  | Spectrograph name |
| CAMERAS | b1 | BOSS CAMERA |
| CCD |  | CCD name |
| CCDID |  | Unique identifier of the CCD |
| CCDTYPE |  | CCD type |
|  |  |  |
|  | EXPOSURE INFO |  |
| FILENAME | sdR-b1-00353047.fit | File basename |
| EXPOSURE | 353047 | Exposure number |
| FLAVOR | arc | exposure type, SDSS spectro style |
| QUALITY | excellent | Exposure Quality |
| MJD | 60000 | Modified Julian Date at start of exposure |
| TAI-BEG | 5184019586.0 | MJD(TAI) seconds at start of integration |
| DATE-OBS | 2023-02-25T05:26:26 | TAI date at start of integration |
| INTSTART |  | Start of the integration |
| INTEND |  | End of the integration |
| REQTIME | 4.0 | requested exposure time |
| EXPTIME | 4.08 | requested exposure time |
| DARKTIME | 22.8705377579 | time between flush end and readout start |
| SHOPETIM | 0.75 | open shutter transit time (s) |
| SHCLOTIM | 0.57 | close shutter transit time (s) |
| GUIDER1 |  | The first guider image for plates |
| GUIDERN |  | The last guider image for plates |
|  |  |  |
|  | EXPOSURE SETTINGS |  |
| DIDFLUSH | True | CCD was flushed before integration |
| SUBFRAME |  | the subframe readout command |
| CCDSUM |  | Horizontal and vertical binning |
| ARCHACF |  | Archon ACF file loaded |
| BUFFER |  | The buffer number read |
| ERRCNT | NONE | BOSSDAQ Error Count |
| SYNCERR | NONE | BOSSDAQ Sync Error Count |
| SLINES | NONE | BOSSDAQ Sync Error Lines |
| PIXERR | NONE | BOSSDAQ Pixel Error Count |
| PLINES | NONE | Pixel Error Lines |
| PFERR | NONE | Pixel Frame Error |
|  |  |  |
|  | FIELD/PLATE INFO |  |
| NAME |  | The name of the currently loaded plate |
| PLATEID |  | The currently loaded plate |
| CARTID | FPS-N | The currently loaded cartridge/instrument |
| MAPID |  | The mapping version of the loaded plate |
| POINTING |  | The currently specified pointing |
| PLATETYP | BHM&MWM | Type of plate (e.g. BOSS, MANGA, APOGEE, APOGEE) |
| SRVYMODE |  | Survey leading this observation and its mode |
| CONFID | 8872 | FPS configuration |
| DESIGNID | 108452 | FPS design |
| FIELDID | 112360 | FPS field |
| SLITID | 0 | spectrograph Normalized slithead ID. |
|  |  |  |
|  | TELESCOPE INFO |  |
| RA | 150.013708 | RA of telescope boresight (deg) |
| DEC | 2.183954 | Dec of telescope boresight (deg) |
| RADEG | 150.01675 | RA of telescope pointing(deg) |
| DECDEG | 2.18325 | Dec of telescope pointing (deg) |
| EQUINOX |  | Equinox of celestial coordinate system |
| OFFRA | 0.0 | Absolute guider offset in RA |
| OFFDEC | -0.1 | Absolute guider offset in DEC |
| OFFPA | -432.0 | Absolute guider offset in PA |
| GSEEING | 1.16 | Seeing from the guider (arcsec) |
| AIRMASS |  | AIRMASS |
| HA |  | HA axis pos. (approx, deg) |
| SPA | 42.674532 | TCC SpiderInstAng |
| ROTPOS | 13.5 | Rotator request position (deg) |
| AZ | 35.354609 | Azimuth axis pos. (approx, deg) |
| ALT | 54.130311 | Altitude axis pos. (approx, deg) |
| IPA | 222.473488 | Rotator axis pos. (approx, deg) |
| FOCUS | 205.0 | User-specified focus offset (um) |
| SCALE | 1.0 | User-specified scale factor |
| OBJSYS | ICRS | The TCC objSys |
| BOREOFFX | 0.0 | TCC Boresight offset (deg) |
| BOREOFFY | 0.0 | TCC Boresight offset (deg) |
| ARCOFFX | -0.00304 | TCC ObjArcOff (deg) |
| ARCOFFY | 0.000704 | TCC ObjArcOff (deg) |
| CALOFFX | 0.0 | TCC CalibOff (deg) |
| CALOFFY | 0.0 | TCC CalibOff (deg) |
| CALOFFR | 0.0 | TCC CalibOff (deg) |
| GUIDOFFX | 0.0 | TCC GuideOff (deg) |
| GUIDOFFY | 0.0 | TCC GuideOff (deg) |
| GUIDOFFR | 0.153533 | TCC GuideOff (deg) |
| M2PISTON | 3973.3 | TCC SecOrient |
| M2XTILT | -0.01 | TCC SecOrient |
| M2YTILT | -0.02 | TCC SecOrient |
| M2XTRAN | -0.01 | TCC SecOrient |
| M2YTRAN | -63.73 | TCC SecOrient |
| M2ZROT | -11.12 | TCC SecOrient |
| M1PISTON | 1.07 | TCC PrimOrient |
| M1XTILT | -59.51 | TCC PrimOrient |
| M1YTILT | -9.21 | TCC PrimOrient |
| M1XTRAN | -512.13 | TCC PrimOrient |
| M1YTRAN | 1906.31 | TCC PrimOrient |
| M1ZROT | 0.03 | TCC PrimOrient |
|  |  |  |
|  | SPECTROGRAPH STATUS |  |
| MECHORIX |  | Orientation in X axis (cm/s2) |
| MECHORIY |  | Orientation in Y axis (cm/s2) |
| MECHORIZ |  | Orientation in Z axis (cm/s2) |
| MCHUMHT | 4.0 | spec mech Hartmann humidity (%) |
| MCHUMCO | 2.0 | spec mech Central optics humidity (%) |
| MCTEMDN | 3.1 | spec mech Median temp (deg C) |
| MCTHT | 3.1 | spec mech Hartmann Top Temp (deg C) |
| MCTRCB | 3.1 | spec mech Red Cam Bottom Temp (deg C) |
| MCTRCT | 3.4 | spec mech Red Cam Top Temp (deg C) |
| MCTBCB | 3.2 | spec mech Blue Cam Bottom Temp (deg C) |
| MCTBCT | 3.1 | spec mech Blue Cam Top Temp (deg C) |
| B2CAMT |  | B2 camera temperature (deg C) |
| B2CAMH |  | B2 camera RH (%) |
| R2CAMT |  | R2 camera temperature (deg C) |
| R2CAMH |  | R2 camera RH (%) |
| COLLT |  | Collimator temperature (deg C) |
| COLLH |  | Collimator RH (%) |
| SPECMT |  | specMech temperature (deg C) |
| ARCHTEMP |  | Archon backplane temperature (deg C) |
| LN2TEMP | 94.922 | LN2 can temperature |
| CCDTEMP | -99.609 | Temperature of the sensor |
| IONPUMP | -7.76 | log10(Ion_Pump_pressure/torr) |
| COLLA | 1742 | The position of the A collimator motor |
| COLLB | 1740 | The position of the B collimator motor |
| COLLC | 1759 | The position of the C collimator motor |
|  |  |  |
|  | VERSIONS |  |
| VJAEGER | 1.3.4a0 | Version of Jaeger |
| VKAIJU | 1.2.4-alpha.0 | Version of Kaiju |
| VCOORDIO | 1.6.2a0 | Version of coordIO |
| VCALIBS | 2023.01.05 | Version of FPS calibrations |
| V_APO | 3.0.1 | Version of the current apoActor |
| V_BOSS | 6.0.2-alpha.0 | Active version of the BOSS ICC |
| V_ARCHON |  | Active version of the BOSS ARCHON Controller |
| ARCHBACK |  | Archon backplane ID |
| ARCHBVER |  | Archon backplane version |
| V_GUIDER |  | version of the current guiderActor |
| V_SOP |  | version of the current sopActor |
| DAQVER |  | BOSS Data Acquisition Version |
| CAMDAQ | 1.5.0:37 | Camera Data Acquisition Version |
| BOSSVER |  | ICC version |
| VERSIDL | 8.8.0 | Version of IDL |
| VERSUTIL | 6.0.0dev | Version of idlutils |
| VERSREAD | v6_1_3 | Version of idlspec2d for pre-processing raw data |
| VERSLOG | trunk 27531 | Version of SPECLOG product |
| VERSFLAT | v1_35 | SPECFLAT version |
| VERS2D |  | Version of idlspec2d for 2D reduction |
|  |  |  |
|  | APO WEATHER |  |
| PRESSURE | 21.549 | APO SDSS 2.5m Air Pressure (inch Hg) |
| WINDD | 204.8 | APO SDSS 2.5m Wind Direction (deg) |
| WINDS | 19.4 | APO SDSS 2.5m Wind Speed (mph) |
| GUSTD | 212.6 | APO SDSS 2.5m Wind Gust Direction (deg) |
| GUSTS | 22.0 | APO SDSS 2.5m Wind Gust Speed (mph) |
| AIRTEMP | 0.0 | APO SDSS 2.5m Outside temperature (deg C) |
| DEWPOINT | 0.0 | APO SDSS 2.5m Dewpoint (deg C) |
| TRUSTEMP | 3.0 | APO SDSS 2.5m Truss Temperature (deg C) |
| HUMIDITY | NaN | APO SDSS 2.5m Humidity (percent) |
| DUSTA | 13771.0 | APO SDSS 2.5m dust (count of 0.3mu/particles/vol |
| DUSTB | 1479.0 | APO SDSS 2.5m dust (count of 1mu/particles/vol/t |
| WINDD25M | -999.0 | Wind Direction at APO SDSS 2.5m (deg) |
| WINDS25M | -999.0 | Wind Speed at APO SDSS 2.5m (deg) |
|  |  |  |
|  | LCO WEATHER |  |
| T_OUT |  | LCO du Pont Outside temperature (deg C) |
| T_IN |  | LCO du Pont Inside temperature (deg C) |
| T_PRIM |  | LCO du Pont Primary mirror temperature (deg C) |
| T_CELL |  | LCO du Pont Cell temperature (deg C) |
| T_FLOOR |  | LCO du Pont Floor temperature (deg C) |
| T_TRUSS |  | LCO du Pont Truss temperature (deg C) |
|  |  |  |
|  | CALIBRATION SETTINGS |  |
| NE | 1 1 1 1 | Ne Arc lamps 1:on 0:off |
| HGCD | 1 1 1 1 | HgCd Arc lamps 1:on 0:off |
| HEAR | 0 0 0 0 | HeAr Arc lamps 1:On 0:off |
| FF | 0 0 0 0 | Flat Field lamps 1:on 0:off |
| FFS | 1 1 1 1 1 1 1 1 | Flatfield Screen 1:closed 0:open |
| HARTMANN | Out | Hartmanns: Left,Right,Out,Closed |
|  |  |  |
|  | REDUCTION |  |
| RDNOISE0 | 2.038 | CCD read noise amp 0 [electrons] |
| RDNOISE1 | 1.91376 | CCD read noise amp 1 [electrons] |
| RDNOISE2 | 1.87194 | CCD read noise amp 2 [electrons] |
| RDNOISE3 | 1.96313 | CCD read noise amp 3 [electrons] |
| PIXFLAT | pixflatave-59768-b1.fits.gz | Name of Pixel Flat used |
| BADPIXEL | badpixels-59747-b1.fits.gz | Name of Badpixel mask used |
|  |  |  |
|  | PIPELINE OUTPUTS |  |
| FBADPIX | 4.05516e-05 | Fraction of bad pixels in raw image |
| BESTCORR | 0.776129 | Best Correlation coefficient |
| TAI | 5184019588.04 | Tai of arc |
| TSEP | 213.5 | Tai seperation from associated flat |
| FLATNAME | sdR-b1-00353044.fit | Name of associated flat |
| ARCNAME | sdR-b1-00353047.fit | Name of arc |
| NMATCH | 28 | Number of lamp lines traced |
| MEDWIDT0 | 0.980685 | Median spectral dispersion widths in LL quadran |
| MEDWIDT1 | 1.00468 | Median spectral dispersion widths in LR quadran |
| MEDWIDT2 | 1.06296 | Median spectral dispersion widths in UL quadran |
| MEDWIDT3 | 1.08981 | Median spectral dispersion widths in UR quadran |
| MEDREX0 | 2.66438 | Median resolution widths in LL quadrant |
| MEDREX1 | 2.70836 | Median resolution widths in LR quadrant |
| MEDREX2 | 3.01527 | Median resolution widths in UL quadrant |
| MEDREX3 | 3.10333 | Median resolution widths in UR quadrant |
| EXTNAME | flux |  |



### HDU1: lambda
The data attribute of HDU 1 stores the wavelengths of good lamp lines (in Angstroms) and the Y position of each fiber on the CCD for the corresponding wavelengths.

#### HDU Type: IMAGE
#### HDU Size:  109 KB

##### Header Table Caption for HDU1
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | IMAGE | Image Extension created by MWRFITS v1.13 |
| BITPIX | -64 |  |
| NAXIS | 2 |  |
| NAXIS1 | 501 |  |
| NAXIS2 | 28 |  |
| PCOUNT | 0 |  |
| GCOUNT | 1 |  |



### HDU2: wset
The HDU 2 data is a binary table whose fields are used to calculate wavelength solution (units of log10 Angstroms) for the arc calibration frames. The Y-positions on the CCD, which is the independent variable and corresponding wavelength solutions (in Angstroms) which is the dependent variable, are fitted to a functional form and the resulting coefficients are stored in the binary table. The use of these coefficients is described in the notes below

#### HDU Type: BINARY TABLE
#### HDU Size:  23 KB

##### Header Table Caption for HDU2
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | BINTABLE | Binary table written by MWRFITS v1.13 |
| BITPIX | 8 | Required value |
| NAXIS | 2 | Required value |
| NAXIS1 | 24024 | Number of bytes per row |
| NAXIS2 | 1 | Number of rows |
| PCOUNT | 0 | Normally 0 (no varying arrays) |
| GCOUNT | 1 | Required value |
| TFIELDS | 4 | Number of columns in table |
| COMMENT |  |  |
| COMMENT |  *** End of mandatory fields *** |  |
| COMMENT |  |  |
| COMMENT |  |  |
| COMMENT |  *** Column formats *** |  |
| COMMENT |  |  |
| COMMENT |  |  |
| COMMENT |  *** Column dimensions (2 D or greater) *** |  |
| COMMENT |  |  |
| TDIM4 | ( 6, 500) |  |
| COMMENT |  |  |
| COMMENT |  *** Column names *** |  |
| COMMENT |  |  |

##### Binary Table Caption for HDU2
Name | Type | Unit | Description |
| --- | --- | --- | --- |
 | FUNC | char[8] |  | describes the function used to fit the wavelength solutions (units of log-10 Angstroms) and Y-positions to a functional form. Chebyshev or Legendre functions are used. The default value is taken as Legendre function. |
 | XMIN | float64 |  | minimum value of the independent variable which is used along with the fitting coefficients, in the fitting function to get the value of dependent variable, which is the wavelength solution. |
 | XMAX | float64 |  | maximum value of the independent variable used by fitting function. |
 | COEFF | float64[3000] |  | fit coefficents |



### HDU3: fibermask
The HDU 3 data stores the fibermask. These are fiber status bits and are set to non-zero to indicate bad status. The status bits used for masking are documented in $IDLUTILS/$IDLUTILS_VER/data/sdss/sdssMaskbits.par.

#### HDU Type: IMAGE
#### HDU Size:  3 KB

##### Header Table Caption for HDU3
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | IMAGE | Image Extension created by MWRFITS v1.13 |
| BITPIX | 64 |  |
| NAXIS | 1 |  |
| NAXIS1 | 500 |  |
| PCOUNT | 0 |  |
| GCOUNT | 1 |  |



### HDU4: dispset
rThe data attribute of HDU 4 gives the line width (in the dispersion axis) for each fiber. This Gaussian sigma is in units of pixels. The Y-positions on the CCD, which is the independent variable and the corresponding line width, which is the dependent variable are fitted to a functional form and the resulting coefficients are stored in a binary table. For instructions on how to use these tracesets, see HDU2 description of this file.

#### HDU Type: BINARY TABLE
#### HDU Size:  15 KB

##### Header Table Caption for HDU4
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | BINTABLE | Binary table written by MWRFITS v1.13 |
| BITPIX | 8 | Required value |
| NAXIS | 2 | Required value |
| NAXIS1 | 16024 | Number of bytes per row |
| NAXIS2 | 1 | Number of rows |
| PCOUNT | 0 | Normally 0 (no varying arrays) |
| GCOUNT | 1 | Required value |
| TFIELDS | 4 | Number of columns in table |
| COMMENT |  |  |
| COMMENT |  *** End of mandatory fields *** |  |
| COMMENT |  |  |
| COMMENT |  |  |
| COMMENT |  *** Column formats *** |  |
| COMMENT |  |  |
| COMMENT |  |  |
| COMMENT |  *** Column dimensions (2 D or greater) *** |  |
| COMMENT |  |  |
| TDIM4 | ( 4, 500) |  |
| COMMENT |  |  |
| COMMENT |  *** Column names *** |  |
| COMMENT |  |  |

##### Binary Table Caption for HDU4
Name | Type | Unit | Description |
| --- | --- | --- | --- |
 | FUNC | char[8] |  | describes the function used to fit the line width (units of pixels) and Y-positions to a functional form. Chebyshev or Legendre functions are used. Default value is taken as Legendre function. |
 | XMIN | float64 |  | minimum value of the independent variable which is used along with the fitting coefficients, in the fitting function to get the value of dependent variable, which is the line width of fibers. |
 | XMAX | float64 |  | maximum value of the independent variable used by fitting function. |
 | COEFF | float64[2000] |  | fit coefficents |



### HDU5: reslset
Traceset structure containing fit coefficients to the emission line wavelength width for each arc fiber bundle

#### HDU Type: BINARY TABLE
#### HDU Size:  15 KB

##### Header Table Caption for HDU5
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | BINTABLE | Binary table written by MWRFITS v1.13 |
| BITPIX | 8 | Required value |
| NAXIS | 2 | Required value |
| NAXIS1 | 16024 | Number of bytes per row |
| NAXIS2 | 1 | Number of rows |
| PCOUNT | 0 | Normally 0 (no varying arrays) |
| GCOUNT | 1 | Required value |
| TFIELDS | 4 | Number of columns in table |
| COMMENT |  |  |
| COMMENT |  *** End of mandatory fields *** |  |
| COMMENT |  |  |
| COMMENT |  |  |
| COMMENT |  *** Column formats *** |  |
| COMMENT |  |  |
| COMMENT |  |  |
| COMMENT |  *** Column dimensions (2 D or greater) *** |  |
| COMMENT |  |  |
| TDIM4 | ( 4, 500) |  |
| COMMENT |  |  |
| COMMENT |  *** Column names *** |  |
| COMMENT |  |  |

##### Binary Table Caption for HDU5
Name | Type | Unit | Description |
| --- | --- | --- | --- |
 | FUNC | char[8] |  | describes the function used to fit the line width (units of pixels) and Y-positions to a functional form. Chebyshev or Legendre functions are used. Default value is taken as Legendre function. |
 | XMIN | float64 |  | minimum value of the independent variable which is used along with the fitting coefficients, in the fitting function to get the value of dependent variable, which is the line width of fibers. |
 | XMAX | float64 |  | maximum value of the independent variable used by fitting function. |
 | COEFF | float64[2000] |  | fit coefficents |



### HDU6: rejline
String set to non-zero for any rejected arc lines

#### HDU Type: IMAGE
#### HDU Size:  109 KB

##### Header Table Caption for HDU6
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | IMAGE | Image Extension created by MWRFITS v1.13 |
| BITPIX | -64 |  |
| NAXIS | 2 |  |
| NAXIS1 | 500 |  |
| NAXIS2 | 28 |  |
| PCOUNT | 0 |  |
| GCOUNT | 1 |  |



### HDU7: XDIF_TSET
Fit residual of lamp lines to fit positions [pixels]

#### HDU Type: IMAGE
#### HDU Size:  3 KB

##### Header Table Caption for HDU7
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | IMAGE | Image Extension created by MWRFITS v1.13 |
| BITPIX | 64 |  |
| NAXIS | 1 |  |
| NAXIS1 | 500 |  |
| PCOUNT | 0 |  |
| GCOUNT | 1 |  |



---
## Notes
How to use these coefficients - Let x be the pixel number of a given trace. We define mu = 2*(x-XMID)/(XMAX-XMIN) and the solution for the wavelength is FUNC(mu) where FUNC is the function stored in the FUNC column in this binary table (it is usually a Legendre polynomials). If XJUMPLO or XJUMPHI are present in the table, the following formulas need to be applied to correct x due to two-phase read-out of CCDs.
  t = (x-XJUMPLO)/(XJUMPHI-XJUMPLO)
  jump = 0 * (t<0) + t * (0<t<1) + 1 * (t>1) 
  x = x + jump * XJUMPVAL
  mu = 2*(x-XMID)/(XMAX-XMIN)
  loglam = FUNC(mu)