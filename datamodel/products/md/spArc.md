# Data Model: spArc


migration: needs update


## Contents
- [Basic Information](#basic-information)
- [Changelog](#changelog)
- [Example HDU List](#example-hdu-list)


---

## Basic Information
This file contains information about flux density, wavelength solution, fibermask and line width obtained from extracted arc calibration frames. This file is generated
as a product of spcalib.pro.

### Naming Convention
Filenames have the form spArc-[c][n]-mmmmmmmm.fits.gz, where c indicates either a blue or red spectrograph, n indicates the spectrograph number (1 or 2) and mmmmmmmm indicates the frame number. An example of filename is spArc-r2-00111704.fits.gz.

### Releases
DR9, DR10, DR12, DR11, DR13, DR14, DR15, DR16, DR17

### Enviroments
BOSS_SPECTRO_REDUX

### Approximate Size
5 MB

### File Type
FITS

### Generated by Product
spCalib.pro

### HDU List for release DR17
  - [HDU0: PRIMARY](#hdu0-primary)
  - [HDU1: ](#hdu1-)
  - [HDU2: ](#hdu2-)
  - [HDU3: ](#hdu3-)
  - [HDU4: ](#hdu4-)


---

## Changelog
Describes changes to the datamodel product and/or file structure from one release to another
 - DR17
   - from: DR16
   - note: No changes
 - DR16
   - from: DR15
   - note: No changes
 - DR15
   - from: DR14
   - note: No changes
 - DR14
   - from: DR13
   - note: No changes
 - DR13
   - from: DR11
   - note: No changes
 - DR11
   - from: DR12
   - note: No changes
 - DR12
   - from: DR10
   - note: No changes
 - DR10
   - from: DR9
   - note: No changes

---
## Example HDU List


### HDU0: PRIMARY
The data attribute of Primary HDU stores the extracted flux for the entire image.
<b>
Required header keywords:
</b>
<b>
Optional header keywords:
</b>

#### HDU Type: IMAGE
#### HDU Size:  7 MB

##### Header Table Caption for HDU0
Key | Value | Comment | |
| --- | --- | --- | --- |
| SIMPLE | True | conforms to FITS standard |
| BITPIX | -32 | array data type |
| NAXIS | 2 | number of array dimensions |
| NAXIS1 | 4112 | length of dimension 1 |
| NAXIS2 | 500 | length of dimension 2 |
| EXTEND | True |  |
| TELESCOP | SDSS 2.5-M | Sloan Digital Sky Survey |
| FILENAME | sdR-b1-00108606.fit | migration: description of keyword/column not found. Needs update |
| CAMERAS | b1 | migration: description of keyword/column not found. Needs update |
| EXPOSURE | 108606 | migration: description of keyword/column not found. Needs update |
| DAQVER | 1.2.8 | migration: description of keyword/column not found. Needs update |
| CAMDAQ | 1.4.1:32 | migration: description of keyword/column not found. Needs update |
| ERRCNT | NONE | migration: description of keyword/column not found. Needs update |
| SYNCERR | NONE | migration: description of keyword/column not found. Needs update |
| SLINES | NONE | migration: description of keyword/column not found. Needs update |
| PIXERR | NONE | migration: description of keyword/column not found. Needs update |
| PLINES | NONE | migration: description of keyword/column not found. Needs update |
| FLAVOR | arc | exposure type, SDSS spectro style |
| BOSSVER | v2_0_17 | ICC version |
| MJD | 55244 | APO fMJD day at start of exposure |
| TAI-BEG | 4773100227.000001 | MJD(TAI) seconds at start of integration |
| DATE-OBS | 2010-02-17T05:10:27 | TAI date at start of integration |
| FF | 0 0 0 0 | FF lamps 1:on 0:0ff |
| NE | 1 1 1 1 | NE lamps 1:on 0:0ff |
| HGCD | 1 1 1 1 | HGCD lamps 1:on 0:0ff |
| FFS | 1 1 1 1 1 1 1 1 | Flatfield Screen 1:closed 0:open |
| OBJSYS | ICRS | The TCC objSys |
| RA | 120.0777 | RA of telescope boresight (deg) |
| DEC | 53.2734 | Dec of telescope boresight (deg) |
| RADEG | 120.0777 | RA of telescope pointing(deg) |
| DECDEG | 53.2734 | Dec of telescope pointing (deg) |
| ROTPOS | 0.0 | Rotator request position (deg) |
| BOREOFFX | 0.0 | TCC Boresight offset, deg |
| BOREOFFY | 0.0 | TCC Boresight offset, deg |
| ARCOFFX | 0.0 | TCC ObjArcOff, deg |
| ARCOFFY | 0.0 | TCC ObjArcOff, deg |
| OBJOFFX | 0.0 | TCC ObjOff, deg |
| OBJOFFY | 0.0 | TCC ObjOff, deg |
| CALOFFX | 0.002 | TCC CalibOff, deg |
| CALOFFY | -0.001 | TCC CalibOff, deg |
| CALOFFR | 0.0 | TCC CalibOff, deg |
| GUIDOFFX | 0.0 | TCC GuideOff, deg |
| GUIDOFFY | 0.0 | TCC GuideOff, deg |
| GUIDOFFR | 0.0 | TCC GuideOff, deg |
| AZ | 177.508 | Azimuth axis pos. (approx, deg) |
| ALT | 69.516 | Altitude axis pos. (approx, deg) |
| IPA | -3.41 | Rotator axis pos. (approx, deg) |
| SPA | 176.6889054674645 | TCC SpiderInstAng |
| FOCUS | 518.08 | User-specified focus offset (um) |
| M2PISTON | 1895.37 | TCC SecOrient |
| M2XTILT | -3.97 | TCC SecOrient |
| M2YTILT | -9.01 | TCC SecOrient |
| M2XTRAN | 9.9 | TCC SecOrient |
| M2YTRAN | -14.38 | TCC SecOrient |
| M1PISTON | 296.25 | TCC PrimOrient |
| M1XTILT | -3.04 | TCC PrimOrient |
| M1YTILT | 5.26 | TCC PrimOrient |
| M1XTRAN | 277.64 | TCC PrimOrient |
| M1YTRAN | 178.07 | TCC PrimOrient |
| SCALE | 0.99997 | User-specified scale factor |
| NAME | 3682-55244-01 | The name of the currently loaded plate |
| PLATEID | 3682 | The currently loaded plate |
| CARTID | 12 | The currently loaded cartridge |
| MAPID | 1 | The mapping version of the loaded plate |
| POINTING | A | The currently specified pointing |
| GUIDER1 | proc-gimg-0422.fits | The first guider image |
| COLLA | -8460 | The position of the A collimator motor |
| COLLB | -8486 | The position of the B collimator motor |
| COLLC | -8505 | The position of the C collimator motor |
| HARTMANN | Out | Hartmanns: Left,Right,Out |
| MC1HUMHT | 38.4 | sp1 mech Hartmann humidity, % |
| MC1HUMCO | 33.8 | sp1 mech Central optics humidity, % |
| MC1TEMDN | -1.1 | sp1 mech Median temp, C |
| MC1THT | -1.3 | sp1 mech Hartmann Top Temp, C |
| MC1TRCB | -1.5 | sp1 mech Red Cam Bottom Temp, C |
| MC1TRCT | -0.7 | sp1 mech Red Cam Top Temp, C |
| MC1TBCB | -1.3 | sp1 mech Blue Cam Bottom Temp, C |
| MC1TBCT | -1.1 | sp1 mech Blue Cam Top Temp, C |
| MC2HUMHT | 32.0 | migration: description of keyword/column not found. Needs update |
| MC2HUMCO | 20.6 | migration: description of keyword/column not found. Needs update |
| MC2TEMDN | -2.0 | migration: description of keyword/column not found. Needs update |
| MC2THT | -1.4 | migration: description of keyword/column not found. Needs update |
| MC2TRCB | -1.6 | migration: description of keyword/column not found. Needs update |
| MC2TRCT | -2.0 | migration: description of keyword/column not found. Needs update |
| MC2TBCB | -2.1 | migration: description of keyword/column not found. Needs update |
| MC2TBCT | -1.6 | migration: description of keyword/column not found. Needs update |
| GUIDERN | proc-gimg-0422.fits | The last guider image |
| EXPTIME | 4.0 | measured exposure time, s |
| SHOPETIM | 0.73 | open shutter transit time, s |
| SHCLOTIM | 0.555 | close shutter transit time, s |
| CAMROW | 0 | migration: description of keyword/column not found. Needs update |
| CAMCOL | 1 | migration: description of keyword/column not found. Needs update |
| AUTHOR | Scott Burles & David Schlegel | migration: description of keyword/column not found. Needs update |
| VERSIDL | 7.1.1 | Version of IDL |
| VERSUTIL | v5_5_17 | Version of idlutils |
| VERSREAD | v5_13_2 | Version of idlspec2d for pre-processing raw dat |
| VERSLOG | trunk 26892 | Version of SPECLOG product |
| VERSFLAT | v1_32 | Version of SPECFLAT product |
| TWOPHASE | False | Extra 1/3 row in wavecal at array center? |
| QUALITY | excellent | migration: description of keyword/column not found. Needs update |
| RDNOISE0 | 2.01114 | CCD read noise amp 0 [electrons] |
| RDNOISE1 | 1.94212 | CCD read noise amp 1 [electrons] |
| RDNOISE2 | 1.8936 | CCD read noise amp 2 [electrons] |
| RDNOISE3 | 1.86914 | CCD read noise amp 3 [electrons] |
| PIXFLAT | pixflatave-55056-b1.fits.gz | migration: description of keyword/column not found. Needs update |
| BADPIXEL | badpixels-55056-b1.fits.gz | migration: description of keyword/column not found. Needs update |
| FBADPIX | 4.82106e-05 | Fraction of bad pixels in raw image |
| BESTCORR | 0.708455 | Best Correlation coefficient |



### HDU1: 
The data attribute of HDU 1 stores the wavelengths of good lamp lines (in Angstroms) and the Y position of each fiber on the CCD for the corresponding wavelengths.
The data in HDU 1 is of size 65 X 501 in which the first of the 501 columns stores the wavelengths of the good lamp lines, and the remaining 500 columns
store the Y positions of those lines for each of the 500 fibers.
<b>
Required header keywords:
</b>
<b>
Optional header keywords:
</b>

#### HDU Type: IMAGE
#### HDU Size:  113 KB

##### Header Table Caption for HDU1
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | IMAGE | Image Extension created by MWRFITS v1.8 |
| BITPIX | -64 | array data type |
| NAXIS | 2 | number of array dimensions |
| NAXIS1 | 501 | length of dimension 2 |
| NAXIS2 | 29 | length of dimension 2 |
| PCOUNT | 0 | Normally 0 (no varying arrays) |
| GCOUNT | 1 | number of groups |



### HDU2: 
The HDU 2 data is a binary table whose fields are used to calculate wavelength solution (units of log10 Angstroms) for the arc calibration frames.
The Y-positions on the CCD, which is the independent variable and corresponding wavelength solutions (in Angstroms) which is the dependent variable, 
are fitted to a functional form and the resulting coefficients are stored in the binary table.

<b>
How to use these coefficients: 
</b>

Let x be the pixel number of a given trace. We define mu = 2*(x-XMID)/(XMAX-XMIN) and the solution for the wavelength 
is FUNC(mu) where FUNC is the function stored in the FUNC column in this binary table (it is usually a Legendre polynomials).

If XJUMPLO or XJUMPHI are present in the table, the following formulas need to be applied to correct x due to two-phase read-out of CCDs.

<code>
<br/>t = (x-XJUMPLO)/(XJUMPHI-XJUMPLO)
<br/>jump = 0 * (t&lt;0) + t * (0&lt;t&lt;1) + 1 * (t&gt;1)
<br/>x = x + jump * XJUMPVAL
<br/>mu = 2*(x-XMID)/(XMAX-XMIN)
<br/>loglam = FUNC(mu)
</code>

#### HDU Type: BINARY TABLE
#### HDU Size:  23 KB

##### Binary Table Caption for HDU2
Name | Type | Unit | Description |
| --- | --- | --- | --- |
 | FUNC | char[8] | migration: unit of keyword/column not found. Needs update | describes the function used to fit the wavelength solutions (units of log-10 Angstroms) and Y-positions to a functional form. |
 | XMIN | float64 | migration: unit of keyword/column not found. Needs update | minimum value of the independent variable used by fitting function. |
 | XMAX | float64 | migration: unit of keyword/column not found. Needs update | maximum value of the independent variable which is used along with the fitting coefficients, in the fitting function to get the value of dependent variable, which is the wavelength solution. |
 | COEFF | float64[3000] | migration: unit of keyword/column not found. Needs update | [3000](float64)  			:  fit coefficents |



### HDU3: 
The HDU 3 data stores the fibermask. These are fiber status bits and are set to non-zero to indicate bad status. The status bits used for masking are documented in $IDLUTILS/v5_4_12/data/sdss/sdssMaskbits.par.
<b>
Required header keywords:
</b>
<b>
Optional header keywords:
</b>

#### HDU Type: IMAGE
#### HDU Size:  1 KB

##### Header Table Caption for HDU3
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | IMAGE | Image Extension created by MWRFITS v1.8 |
| BITPIX | 32 | array data type |
| NAXIS | 1 | number of array dimensions |
| NAXIS1 | 500 | length of dimension 1 |
| PCOUNT | 0 | Normally 0 (no varying arrays) |
| GCOUNT | 1 | number of groups |



### HDU4: 
The data attribute of HDU 4 gives the line width (in the dispersion axis) for each fiber. This Gaussian sigma is in units of pixels.
The Y-positions on the CCD, which is the independent variable and the corresponding line width, which is the dependent variable are fitted 
to a functional form and the resulting coefficients are stored in a binary table.

For instructions on how to use these tracesets, see HDU2 description of this file.

#### HDU Type: BINARY TABLE
#### HDU Size:  15 KB

##### Binary Table Caption for HDU4
Name | Type | Unit | Description |
| --- | --- | --- | --- |
 | FUNC | char[8] | migration: unit of keyword/column not found. Needs update | describes the function used to fit the line width (units of pixels) and Y-positions to a functional form. |
 | XMIN | float64 | migration: unit of keyword/column not found. Needs update | minimum value of the independent variable used by fitting function. |
 | XMAX | float64 | migration: unit of keyword/column not found. Needs update | maximum value of the independent variable which is used along with the fitting coefficients, in the fitting function to get the value of dependent variable, which is the line width of fibers. |
 | COEFF | float64[2000] | migration: unit of keyword/column not found. Needs update | migration: description of keyword/column not found. Needs update |


