# Data Model: frame


migration: needs update


## Contents
- [Basic Information](#basic-information)
- [Changelog](#changelog)
- [Example HDU List](#example-hdu-list)


---

## Basic Information
The calibrated, sky-subtracted corrected frame plus associated
calibration meta-data. The units of the images are in
<a href="http://www.sdss.org/dr13/help/glossary/#nanomaggie">nanomaggies</a>.
It is kept compressed under "bzip2", which we
have found is the most efficient compressor of this format.  In
addition, there is a lossy compression applied to the floating point
values (which retains accuracy at the 0.1 percent level). The IDL
routine "read_frame.pro" in photoop will back out the calibration and
sky-subtraction from this file if necessary, in steps explained
below. Also explained below is how to calculate the noise in the
image.

### Naming Convention
<code>frame-[ugriz]-[0-9]{6}-[1-6]-[0-9]{4}\.fits\.bz2</code>, where
<code>[ugriz]</code> is the filter, <code>[0-9]{6}</code> is a zero-padded six-digit
number containing the run number, <code>[1-6]</code> is the camera column ('camcol') and
<code>[0-9]{4}</code> is the zero-padded, four-digit frame sequence number.

### Releases
DR9, DR10, DR12, DR11, DR13, DR14, DR15, DR16, WORK

### Enviroments
BOSS_PHOTOOBJ

### Approximate Size
4 MB

### File Type
BZ2

### Generated by Product
sas

### HDU List for release WORK
  - [HDU0: PRIMARY](#hdu0-primary)
  - [HDU1: ](#hdu1-)
  - [HDU2: ](#hdu2-)
  - [HDU3: ](#hdu3-)


---

## Changelog
Describes changes to the datamodel product and/or file structure from one release to another
 - WORK
   - from: DR16
   - note: No changes
 - DR16
   - from: DR15
   - note: No changes
 - DR15
   - from: DR14
   - note: No changes
 - DR14
   - from: DR13
   - note: No changes
 - DR13
   - from: DR11
   - note: No changes
 - DR11
   - from: DR12
   - note: No changes
 - DR12
   - from: DR10
   - note: No changes
 - DR10
   - from: DR9
   - note: No changes

---
## Example HDU List


### HDU0: PRIMARY
The "image", a 2048x1489 array of floating point values, the
calibrated and sky-subtracted version of the fpC "corrected frame"
files produced by photo. Units are in
<a href="http://www.sdss.org/dr13/help/glossary/#nanomaggie">nanomaggies</a>.
The header has additional WCS information.  These have been altered
from the fpC versions to correct for any offsets from the astrom
solutions found in the asTrans files.
The image itself has had the FLOATCOMPRESS algorithm
(see the <a href="http://www.sdss.org/dr13/software/idlutils/">idlutils</a> package)
applied to it, keeping 10 significant binary digits. This approach guarantees that the
precision is kept strictly within 0.1 percent per pixel, and allows a very efficient
compression using bzip2. No special scaling or adjustment need be
applied to the values when read in.

#### HDU Type: IMAGE
#### HDU Size:  11 MB

##### Header Table Caption for HDU0
Key | Value | Comment | |
| --- | --- | --- | --- |
| SIMPLE | True | Conforms to FITS standard |
| BITPIX | -32 | 32 bit floating point |
| NAXIS | 2 | 2d image |
| NAXIS1 | 2048 | length of dimension 1 |
| NAXIS2 | 1489 | length of dimension 2 |
| EXTEND | True | Extensions may be present |
| BZERO | 0.0 | migration: description of keyword/column not found. Needs update |
| BSCALE | 1.0 | migration: description of keyword/column not found. Needs update |
| TAI | 4445989166.65 | migration: description of keyword/column not found. Needs update |
| RA | 357.82989 | migration: description of keyword/column not found. Needs update |
| DEC | 49.752044 | migration: description of keyword/column not found. Needs update |
| SPA | 355.624 | migration: description of keyword/column not found. Needs update |
| IPA | 139.987 | migration: description of keyword/column not found. Needs update |
| IPARATE | 0.0168 | migration: description of keyword/column not found. Needs update |
| AZ | 153.3062 | migration: description of keyword/column not found. Needs update |
| ALT | 70.256777 | migration: description of keyword/column not found. Needs update |
| FOCUS | -1000000000000.0 | migration: description of keyword/column not found. Needs update |
| DATE-OBS | 1999-10-07 | migration: description of keyword/column not found. Needs update |
| TAIHMS | 04:59:26.65 | migration: description of keyword/column not found. Needs update |
| COMMENT |  TAI,RA,DEC,SPA,IPA,IPARATE,AZ,ALT,FOCUS at reading of col 0, row 0 | migration: description of keyword/column not found. Needs update |
| ORIGIN | SDSS | migration: description of keyword/column not found. Needs update |
| TELESCOP | 2.5m | migration: description of keyword/column not found. Needs update |
| TIMESYS | TAI | migration: description of keyword/column not found. Needs update |
| RUN | 1000 | migration: description of keyword/column not found. Needs update |
| FRAME | 35 | migration: description of keyword/column not found. Needs update |
| CCDLOC | 51 | migration: description of keyword/column not found. Needs update |
| STRIPE | 100 | migration: description of keyword/column not found. Needs update |
| STRIP | O | migration: description of keyword/column not found. Needs update |
| FLAVOR | engineering | migration: description of keyword/column not found. Needs update |
| SYS_SCN | mean | migration: description of keyword/column not found. Needs update |
| EQNX_SCN | 2000.0 | migration: description of keyword/column not found. Needs update |
| NODE | 297.05138 | migration: description of keyword/column not found. Needs update |
| INCL | 0.00322 | migration: description of keyword/column not found. Needs update |
| XBORE | 0.0 | migration: description of keyword/column not found. Needs update |
| YBORE | 0.0 | migration: description of keyword/column not found. Needs update |
| OBJECT | 100 O | migration: description of keyword/column not found. Needs update |
| EXPTIME | 53.907456 | migration: description of keyword/column not found. Needs update |
| SYSTEM | FK5 | migration: description of keyword/column not found. Needs update |
| CCDMODE | DRIFT | migration: description of keyword/column not found. Needs update |
| C_OBS | 26322 | migration: description of keyword/column not found. Needs update |
| COLBIN | 1 | migration: description of keyword/column not found. Needs update |
| ROWBIN | 1 | migration: description of keyword/column not found. Needs update |
| DAVERS | v14_1 | migration: description of keyword/column not found. Needs update |
| COMMENT |  CCD-specific parameters | migration: description of keyword/column not found. Needs update |
| CAMROW | 5 | migration: description of keyword/column not found. Needs update |
| BADLINES | 0 | migration: description of keyword/column not found. Needs update |
| EQUINOX | 2000.0 | migration: description of keyword/column not found. Needs update |
| SOFTBIAS | 1000 | migration: description of keyword/column not found. Needs update |
| BUNIT | nanomaggy | migration: description of keyword/column not found. Needs update |
| FILTER | g | migration: description of keyword/column not found. Needs update |
| CAMCOL | 1 | migration: description of keyword/column not found. Needs update |
| VERSION | v5_6_3 | migration: description of keyword/column not found. Needs update |
| DERV_VER | NOCVS:v8_23 | migration: description of keyword/column not found. Needs update |
| ASTR_VER | NOCVS:v5_24 | migration: description of keyword/column not found. Needs update |
| ASTRO_ID | 2009-05-20T02:00:18 29268 | migration: description of keyword/column not found. Needs update |
| BIAS_ID | PS | migration: description of keyword/column not found. Needs update |
| FRAME_ID | 2009-09-29T12:01:23 32582 | migration: description of keyword/column not found. Needs update |
| KO_VER | devel | migration: description of keyword/column not found. Needs update |
| PS_ID | 2009-05-20T00:28:14 17185 camCol 1 | migration: description of keyword/column not found. Needs update |
| ATVSN | NOCVS:v5_24 | migration: description of keyword/column not found. Needs update |
| RADECSYS | ICRS | migration: description of keyword/column not found. Needs update |
| CTYPE1 | RA---TAN | WCS header type |
| CTYPE2 | DEC--TAN | WCS header type |
| CUNIT1 | deg | WCS header units |
| CUNIT2 | deg | WCS header units |
| CRPIX1 | 1025.0 | X of reference pixel |
| CRPIX2 | 745.0 | Y of reference pixel |
| CRVAL1 | 359.507324755 | RA of reference pixel (deg) |
| CRVAL2 | 49.1893863092 | Dec of reference pixel (deg) |
| CD1_1 | -0.000109765838075 | RA deg per column pixel |
| CD1_2 | -5.8644459069e-06 | RA deg per row pixel |
| CD2_1 | -5.80149584993e-06 | Dec deg per column pixel |
| CD2_2 | 0.000109908527461 | Dec deg per row pixel |
| HISTORY | GSSSPUTAST: Sep 29 12:01:32 2009 | migration: description of keyword/column not found. Needs update |
| COMMENT |  Calibration parameters | migration: description of keyword/column not found. Needs update |
| COMMENT |  Floats truncated at 10 binary digits with FLOATCOMPRESS | migration: description of keyword/column not found. Needs update |
| NMGY | 0.0673417 | calibration value translating counts to <a href="http://www.sdss.org/dr13/help/glossary/#nanomaggie">nanomaggies</a> (Already applied!) |
| NMGYIVAR | 0.0483683 | calibration value inverse variance |
| VERSIDL | 7.0 | Version of IDL |
| VERSUTIL | v5_5_5 | Version of idlutils |
| VERSPOP | v1_11_1 | Version of photoop |
| PCALIB | /clusterfs/riemann/raid006/bosswork/groups/boss/calib/2009-06-14/cal | value of PHOTO_CALIB environment variable (that is, which version of the calibrations this is) |
| PSKY | /clusterfs/riemann/raid006/bosswork/groups/boss/photo/sky | value of PHOTO_SKY environment variable (that is, which version of the sky estimate this is) |
| RERUN | 301 | rerun of photo associated with this corrected frame |
| HISTORY | SDSS_FRAME_ASTROM: Astrometry fixed for dr9 Sat Jun  9 03:28:18 2012 | migration: description of keyword/column not found. Needs update |



### HDU1: 
The "calibvec", a 2048-element array of "float32" values,
encompassing the flat-field correction to apply, multiplied by the
calibration.  Translates the counts in the original image into
<a href="http://www.sdss.org/dr13/help/glossary/#nanomaggie">nanomaggies</a>.
The calibrations have ALREADY been applied to the HDU0, so this
calibration vector is only to be used to <i>decalibrate</i> an image
back into counts.

#### HDU Type: IMAGE
#### HDU Size:  8 KB

##### Header Table Caption for HDU1
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | IMAGE | Image Extension |
| BITPIX | -32 | 32 bit floating point |
| NAXIS | 1 | 1d image |
| NAXIS1 | 2048 | length of dimension 1 |
| PCOUNT | 0 | number of group parameters |
| GCOUNT | 1 | number of groups |



### HDU2: 
The "sky", an approximately 256x192 array of "float32" values
(there are some variations around the y-size of the array), with
information about how to interpolate it to the full image size. These
sky values are determined from the global sky fits across the run (not
photo).
There are cases at the end of runs where the y-size
of <code>ALLSKY</code> is less than 186, which requires one to
extrapolate off the end of the <code>ALLSKY</code> image in the
y-direction when using <code>XINTERP</code>
	and <code>YINTERP</code>. This extrapolation should be a constant
	extrapolation (not linear).
The sky values have ALREADY been subtracted from HDU0, so this
sky estimate is only to be used to return an image to its (near)
original set of values.

#### HDU Type: BINARY TABLE
#### HDU Size:  204 KB

##### Binary Table Caption for HDU2
Name | Type | Unit | Description |
| --- | --- | --- | --- |
 | ALLSKY | float32[48896] | migration: unit of keyword/column not found. Needs update | the binned sky values, in units of counts |
 | XINTERP | float32[2048] | migration: unit of keyword/column not found. Needs update | X pixel-values to interpolate "allsky" into to produce a full image of the sky (bilinear interpolation is fine) |
 | YINTERP | float32[1489] | migration: unit of keyword/column not found. Needs update | Y pixel-values to interpolate "allsky" into to produce a full image of the sky (bilinear interpolation is fine) |



### HDU3: 
Detailed astrometric information for the field. Basically the
asTrans structure as found in the <a href="/datamodel/files/PHOTO_REDUX/RERUN/RUN/astrom/asTrans.html">asTrans</a>
files.

#### HDU Type: BINARY TABLE
#### HDU Size:  216 bytes

##### Binary Table Caption for HDU3
Name | Type | Unit | Description |
| --- | --- | --- | --- |
 | RUN | int32 | migration: unit of keyword/column not found. Needs update | Run number |
 | RERUN | char[3] | migration: unit of keyword/column not found. Needs update | Photometric reduction version |
 | CAMCOL | int32 | migration: unit of keyword/column not found. Needs update | Column in the imaging camera. |
 | FILTER | char | migration: unit of keyword/column not found. Needs update | Filter (u, g, r, i, or z). |
 | NODE | float64 | migration: unit of keyword/column not found. Needs update | RA of great circle's asending node. (degrees) |
 | INCL | float64 | migration: unit of keyword/column not found. Needs update | RA of great circle's asending node. (degrees) |
 | NAXIS | int32[2] | migration: unit of keyword/column not found. Needs update | The dimensions of the image the astrometry is based on.  Usually 2048x1489, but could be different in principle for binned runs. |
 | FIELD | int32 | migration: unit of keyword/column not found. Needs update | Field sequence number within the run. |
 | A | float64 | migration: unit of keyword/column not found. Needs update | A coefficient. |
 | B | float64 | migration: unit of keyword/column not found. Needs update | B coefficient. |
 | C | float64 | migration: unit of keyword/column not found. Needs update | C coefficient. |
 | D | float64 | migration: unit of keyword/column not found. Needs update | D coefficient. |
 | E | float64 | migration: unit of keyword/column not found. Needs update | E coefficient. |
 | F | float64 | migration: unit of keyword/column not found. Needs update | F coefficient. |
 | DROW0 | float64 | migration: unit of keyword/column not found. Needs update | Zero-order row distortion coefficient. |
 | DROW1 | float64 | migration: unit of keyword/column not found. Needs update | First-order row distortion coefficient. |
 | DROW2 | float64 | migration: unit of keyword/column not found. Needs update | Second-order row distortion coefficient. |
 | DROW3 | float64 | migration: unit of keyword/column not found. Needs update | Third-order row distortion coefficient. |
 | DCOL0 | float64 | migration: unit of keyword/column not found. Needs update | Zero-order column distortion coefficient. |
 | DCOL1 | float64 | migration: unit of keyword/column not found. Needs update | First-order column distortion coefficient. |
 | DCOL2 | float64 | migration: unit of keyword/column not found. Needs update | Second-order column distortion coefficient. |
 | DCOL3 | float64 | migration: unit of keyword/column not found. Needs update | Third-order column distortion coefficient. |
 | CSROW | float64 | migration: unit of keyword/column not found. Needs update | Slope in row DCR correction for blue objects. |
 | CSCOL | float64 | migration: unit of keyword/column not found. Needs update | Slope in column DCR correction for blue objects. |
 | CCROW | float64 | migration: unit of keyword/column not found. Needs update | Constant row DCR correction for red objects. |
 | CCCOL | float64 | migration: unit of keyword/column not found. Needs update | Constant column DCR correction for red objects. |
 | RICUT | float64 | migration: unit of keyword/column not found. Needs update | r'-i' cutoff between blue and red objects. |
 | MJD | float64 | migration: unit of keyword/column not found. Needs update | MJD(TAI) when row 0 was read. |
 | AIRMASS | float64 | migration: unit of keyword/column not found. Needs update | Airmass for star at frame center (mid exposure) |
 | MUERR | float32 | migration: unit of keyword/column not found. Needs update | Error in transformation in mu |
 | NUERR | float32 | migration: unit of keyword/column not found. Needs update | Error in transformation in nu |


