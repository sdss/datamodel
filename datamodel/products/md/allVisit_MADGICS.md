# Data Model: allVisit_MADGICS


Summary file of scalar outputs from apMADGICS pipeline processing of all visit spectra in APOGEE DR17.


## Contents
- [Basic Information](#basic-information)
- [Changelog](#changelog)
- [Example HDUS List](#example-hdus-list)
- [Notes](#notes)
- [Regrets](#regrets)
---

## Basic Information
Summary file of scalar outputs from apMADGICS pipeline processing of all visit spectra in APOGEE DR17. Contains stellar radial velocities, DIB properties, and crossmatches to the standard DRP allStar and allVisit files.

### Naming Convention
$APMADGICS/[VERS]/outdir_wu_[STAR_PRIOR_TYPE]/allVisit_MADGICS_[VERS]_[STAR_PRIOR_TYPE].fits where VERS = "v2024_03_16" for DR19 and STAR_PRIOR_TYPE has one of the values ["th", "dd"]

### Releases
DR19

### Enviroments
APMADGICS

### Approximate Size
2 GB

### File Type
FITS

### Generated by Product
https://github.com/andrew-saydjari/apMADGICS.jl

### Is a VAC
False

### Data Level
3.3.0

### HDUS List for release DR19
  - [HDU0: PRIMARY](#hdu0-primary)
  - [HDU1](#hdu1)

---

## Changelog
DR19 is the first release of apMADGICS

---
## Example HDUS List

### HDU0: PRIMARY
empty header

#### HDU Type: IMAGE
#### HDU Size:  0 bytes

##### Header Table Caption for HDU0
Key | Value | Comment | |
| --- | --- | --- | --- |
| SIMPLE | True | file does conform to FITS standard |
| BITPIX | 16 | number of bits per data pixel |
| NAXIS | 0 | number of data axes |
| EXTEND | True | FITS dataset may contain extensions |
| COMMENT |   FITS (Flexible Image Transport System) format is defined in 'Astronomy |  |
| COMMENT |   and Astrophysics', volume 376, page 359; bibcode: 2001A&A...376..359H |  |



### HDU1: 
Visit summary table of scalar outputs from apMADGICS.jl

#### HDU Type: BINARY TABLE
#### HDU Size:  2 GB

##### Header Table Caption for HDU1
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | BINTABLE | binary table extension |
| BITPIX | 8 | 8-bit bytes |
| NAXIS | 2 | 2-dimensional binary table |
| NAXIS1 | 875 | width of table in bytes |
| NAXIS2 | 2618012 | number of rows in table |
| PCOUNT | 0 | size of special data area |
| GCOUNT | 1 | one data group (required keyword) |
| TFIELDS | 113 | number of fields in each row |
| TDIM1 | (1) | size of the multidimensional array |
| TDIM2 | (1) | size of the multidimensional array |
| TDIM3 | (1) | size of the multidimensional array |
| TDIM4 | (1) | size of the multidimensional array |
| TDIM5 | (1) | size of the multidimensional array |
| TDIM6 | (1) | size of the multidimensional array |
| TDIM7 | (1) | size of the multidimensional array |
| TDIM8 | (1) | size of the multidimensional array |
| TDIM9 | (1) | size of the multidimensional array |
| TDIM10 | (1) | size of the multidimensional array |
| TDIM11 | (1) | size of the multidimensional array |
| TDIM12 | (1) | size of the multidimensional array |
| TDIM13 | (1) | size of the multidimensional array |
| TDIM14 | (1) | size of the multidimensional array |
| TDIM15 | (1) | size of the multidimensional array |
| TDIM16 | (1) | size of the multidimensional array |
| TDIM17 | (1) | size of the multidimensional array |
| TDIM18 | (1) | size of the multidimensional array |
| TDIM19 | (1) | size of the multidimensional array |
| TDIM20 | (1) | size of the multidimensional array |
| TDIM21 | (1) | size of the multidimensional array |
| TDIM22 | (1) | size of the multidimensional array |
| TDIM23 | (1) | size of the multidimensional array |
| TDIM24 | (1) | size of the multidimensional array |
| TDIM25 | (1) | size of the multidimensional array |
| TDIM26 | (1) | size of the multidimensional array |
| TDIM27 | (1) | size of the multidimensional array |
| TDIM28 | (1) | size of the multidimensional array |
| TDIM29 | (1) | size of the multidimensional array |
| TDIM30 | (1) | size of the multidimensional array |
| TDIM31 | (1) | size of the multidimensional array |
| TDIM32 | (1) | size of the multidimensional array |
| TDIM33 | (1) | size of the multidimensional array |
| TDIM34 | (1) | size of the multidimensional array |
| TDIM35 | (1) | size of the multidimensional array |
| TDIM36 | (1) | size of the multidimensional array |
| TDIM37 | (1) | size of the multidimensional array |
| TDIM38 | (1) | size of the multidimensional array |
| TDIM39 | (1) | size of the multidimensional array |
| TDIM40 | (1) | size of the multidimensional array |
| TDIM41 | (1) | size of the multidimensional array |
| TDIM42 | (1) | size of the multidimensional array |
| TDIM43 | (1) | size of the multidimensional array |
| TDIM44 | (1) | size of the multidimensional array |
| TDIM45 | (12) | size of the multidimensional array |
| TDIM46 | (1) | size of the multidimensional array |
| TDIM47 | (1) | size of the multidimensional array |
| TDIM48 | (1) | size of the multidimensional array |
| TDIM49 | (1) | size of the multidimensional array |
| TDIM50 | (1) | size of the multidimensional array |
| TDIM51 | (1) | size of the multidimensional array |
| TDIM52 | (1) | size of the multidimensional array |
| TDIM53 | (1) | size of the multidimensional array |
| TDIM54 | (1) | size of the multidimensional array |
| TDIM55 | (1) | size of the multidimensional array |
| TDIM56 | (1) | size of the multidimensional array |
| TDIM57 | (1) | size of the multidimensional array |
| TDIM58 | (1) | size of the multidimensional array |
| TDIM59 | (1) | size of the multidimensional array |
| TDIM60 | (1) | size of the multidimensional array |
| TDIM61 | (1) | size of the multidimensional array |
| TDIM62 | (1) | size of the multidimensional array |
| TDIM63 | (1) | size of the multidimensional array |
| TDIM64 | (1) | size of the multidimensional array |
| TDIM65 | (1) | size of the multidimensional array |
| TDIM66 | (1) | size of the multidimensional array |
| TDIM67 | (1) | size of the multidimensional array |
| TDIM68 | (1) | size of the multidimensional array |
| TDIM69 | (1) | size of the multidimensional array |
| TDIM70 | (1) | size of the multidimensional array |
| TDIM71 | (1) | size of the multidimensional array |
| TDIM72 | (1) | size of the multidimensional array |
| TDIM73 | (1) | size of the multidimensional array |
| TDIM74 | (1) | size of the multidimensional array |
| TDIM75 | (1) | size of the multidimensional array |
| TDIM76 | (1) | size of the multidimensional array |
| TDIM77 | (1) | size of the multidimensional array |
| TDIM78 | (1) | size of the multidimensional array |
| TDIM79 | (1) | size of the multidimensional array |
| TDIM80 | (19) | size of the multidimensional array |
| TDIM81 | (1) | size of the multidimensional array |
| TDIM82 | (1) | size of the multidimensional array |
| TDIM83 | (1) | size of the multidimensional array |
| TDIM84 | (1) | size of the multidimensional array |
| TDIM85 | (1) | size of the multidimensional array |
| TDIM86 | (1) | size of the multidimensional array |
| TDIM87 | (1) | size of the multidimensional array |
| TDIM88 | (1) | size of the multidimensional array |
| TDIM89 | (1) | size of the multidimensional array |
| TDIM90 | (1) | size of the multidimensional array |
| TDIM91 | (1) | size of the multidimensional array |
| TDIM92 | (1) | size of the multidimensional array |
| TDIM93 | (1) | size of the multidimensional array |
| TDIM94 | (1) | size of the multidimensional array |
| TDIM95 | (6) | size of the multidimensional array |
| TDIM96 | (1) | size of the multidimensional array |
| TDIM97 | (1) | size of the multidimensional array |
| TDIM98 | (1) | size of the multidimensional array |
| TDIM99 | (1) | size of the multidimensional array |
| TDIM100 | (1) | size of the multidimensional array |
| TDIM101 | (1) | size of the multidimensional array |
| TDIM102 | (1) | size of the multidimensional array |
| TDIM103 | (1) | size of the multidimensional array |
| TDIM104 | (1) | size of the multidimensional array |
| TDIM105 | (1) | size of the multidimensional array |
| TDIM106 | (1) | size of the multidimensional array |
| TDIM107 | (19) | size of the multidimensional array |
| TDIM108 | (1) | size of the multidimensional array |
| TDIM109 | (1) | size of the multidimensional array |
| TDIM110 | (1) | size of the multidimensional array |
| TDIM111 | (1) | size of the multidimensional array |
| TDIM112 | (1) | size of the multidimensional array |
| TDIM113 | (1) | size of the multidimensional array |

##### Binary Table Caption for HDU1
Name | Type | Unit | Description |
| --- | --- | --- | --- |
 | DIB_minchi2_final_1_15273 | float64[1] |  | minimum value of the delta chi2 at the optimum for adding DIB model 1_15273 to the MADGICS model for the visit spectrum |
 | tot_p5chi2_v1_1_15273 | float64[1] |  | Total chi2 for the MADGICS model after including the DIB model 1_15273 |
 | DR17_LOGG | float32[1] | log10(cm/s²) | log(g) from ASPCAP allStar file for DR17 |
 | DIB_sigval_final_3_15672 | float64[1] | Å | DIB width sigma value at optimum for DIB model 3_15672 |
 | tot_p5chi2_v1_2_15273 | float64[1] |  | Total chi2 for the MADGICS model after including the DIB model 2_15273 |
 | ingestBit | int64[1] |  | Bit mask value indicating any issues with ingesting the standard DRP spectra by the apMADGICS pipeline. See https://github.com/andrew-saydjari/apMADGICS.jl for more |
 | DEC | float64[1] | deg | Declination (J2000) |
 | EW_dib_2_15273 | float64[1] | Å | Equivalent width of DIB in the 2_15273 DIB model |
 | RV_pixoff_disc_final | float64[1] | pixels | Discrete (grid point) pixel offset nearest stellar radial velocity optimum |
 | EW_dib_err_1_15273 | float64[1] | Å | Uncertainty in DIB equivalent width for DIB model 1_15273 |
 | a_relFlux | float64[1] |  | Relative fluxing applied upstream by DRP to chip a |
 | DIB_minchi2_final_2_15273 | float64[1] |  | minimum value of the delta chi2 at the optimum for adding DIB model 2_15273 to the MADGICS model for the visit spectrum |
 | EW_dib | float64[1] | Å | Equivalent width of DIB in 2_15273 DIB model |
 | skyscale1 | float64[1] | ADU | Second pass median sky flux in apMADGICS sky component model of the visit |
 | DIB_sigval_disc_final_2_15273 | float64[1] | Å | Discrete DIB width sigma value (on gridpoint) at optimum for DIB model 2_15273 |
 | RV_verr | float64[1] | km/s | Stellar radial velocity error from apMADGICS, calibrated EXCEPT for systematics (should be used with STAR_PRIOR_TYPE=th) |
 | data_pix_cnt | int64[1] |  | Number of unmasked pixels in the input spectrum to apMADGICS component separation |
 | b_relFlux | float64[1] |  | Relative fluxing applied upstream by DRP to chip b |
 | GAIAEDR3_SOURCE_ID | int64[1] |  | Gaia source ID from Gaia EDR3 |
 | DRP_VREL | float64[1] | km/s | Stellar radial velocity in the observed frame from standard DRP (km/s) |
 | EW_dib_err_3_15672 | float64[1] | Å | Uncertainty in DIB equivalent width for DIB model 3_15672 |
 | dib_snr | float64[1] |  | Calibrated signal-to-noise ration for DIB detection under DIB model 2_15273 |
 | DRP_SNR | float32[1] |  | Visit signal-to-noise ratio estimate from standard DRP |
 | DIBchi2_residuals_2_15273 | float64[1] |  | Chi2 of the residual component after fitting DIB model 2_15273 |
 | EW_dib_3_15672 | float64[1] | Å | Equivalent width of DIB in the 3_15672 DIB model |
 | DIB_v_LSR_COframe | float64[1] | km/s | Radial velocity of DIB in the local standard of rest used by Dame et al. 2001 for DIB model 2_15273 |
 | fluxerr2_nans | int64[1] |  | Number of nan pixels in the reinterpolated flux variance spectrum |
 | GX | float64[1] | kpc | Galactocentric cartesian X-coordinate |
 | RV_vel | float64[1] | km/s | Stellar radial velocity from apMADGICS in observed frame (should be used with STAR_PRIOR_TYPE=th) |
 | DIB_sigval_disc_final_3_15672 | float64[1] | Å | Discrete DIB width sigma value (on gridpoint) at optimum for DIB model 3_15672 |
 | RV_pixoff_final | float64[1] | pixels | Pixel offset nearest stellar radial velocity optimum |
 | RVchi2_residuals | float64[1] |  | Chi2 value for the residual component after the RV fitting step for the apMADGICS component separation |
 | map2madgics | int64[1] |  | Index mapping the apMADGICS output files to the ordering of this file. CAUTION 1-indexed (not 0-indexed). Not identity mapping because we drop spectra that are entirely NaNs from this summary table. |
 | DIB_pixoff_disc_final_3_15672 | float64[1] | pixels | DIB discrete pixel offset at optimum for DIB model 3_15672 |
 | DIB_pixoff_final_3_15672 | float64[1] | pixels | DIB pixel offset at optimum for DIB model 3_15672 |
 | DIBchi2_residuals_3_15672 | float64[1] |  | Chi2 of the residual component after fitting DIB model 3_15672 |
 | DIB_pixoff_disc_final_4_15672 | float64[1] | pixels | DIB discrete pixel offset at optimum for DIB model 4_15672 |
 | DIB_flag_1_15273 | int64[1] |  | Flag describing the success/failure of gridsearch fiting DIB model 1_15273. See https://github.com/andrew-saydjari/apMADGICS.jl/tree/main for explaination of bit values. |
 | c_relFlux | float64[1] |  | Relative fluxing applied upstream by DRP to chip c |
 | DR17_VSINI | float32[1] | km/s | VSINI from ASPCAP allStar file for DR17 |
 | GLAT | float64[1] | deg | Galactic latitude |
 | DIB_pixoff_final_1_15273 | float64[1] | pixels | DIB pixel offset at optimum for DIB model 1_15273 |
 | GAIAEDR3_R_MED_GEO | float32[1] | pc | Gaia Bailer-Jones GEO distance estimate r_est from Gaia EDR3 |
 | DIB_sig | float64[1] | Å | DIB width sigma for DIB model 2_15273 |
 | PLATE | char[12] |  | Plate ID of observation |
 | DRP_STARFLAG | int64[1] |  | Flag from standard DRP processing for star condition taken from bitwise OR of individual visits, see bitmask definitions |
 | DIBchi2_residuals_1_15273 | float64[1] |  | Chi2 of the residual component after fitting DIB model 1_15273 |
 | tot_p5chi2_v0 | float64[1] |  | Total chi2 for the MADGICS model including only the sky continuum, (faint) sky lines, stellar continuum, stellar lines, and residual components |
 | flux_nans | int64[1] |  | Number of nan pixels in the reinterpolated flux spectrum |
 | DIB_sig_err | float64[1] | Å | Calibrated uncertainty on DIB width sigma for DIB model 2_15273 |
 | starscale1 | float64[1] | ADU | Second pass median star flux in apMADGICS star continuum component model of the visit |
 | DIB_sigval_final_2_15273 | float64[1] | Å | DIB width sigma value at optimum for DIB model 2_15273 |
 | DRP_VRELERR | float64[1] | km/s | Uncertainty on the radial velocity from the stadard DRP |
 | map2visit | int64[1] |  | Index mapping the standard DRP allVisit file to the ordering of this file. CAUTION 1-indexed (not 0-indexed) |
 | EW_dib_1_15273 | float64[1] | Å | Equivalent width of DIB in the 1_15273 DIB model |
 | RV_bary_offcor | float64[1] | km/s | Stellar radial velocity from apMADGICS in the frame of the solar system barycenter and also corrected for fiber-fiber RV variations (should be used with STAR_PRIOR_TYPE=th) |
 | adjfiberindx | int64[1] |  | A unique fiber identifier running 1 to 600 to handle fibers at both APO and LCO |
 | frame_counts | int64[1] |  | Number of contiguous exposures that were combined into a given visit |
 | DIB_minchi2_final_3_15672 | float64[1] |  | minimum value of the delta chi2 at the optimum for adding DIB model 3_15672 to the MADGICS model for the visit spectrum |
 | RV_minchi2_final | float64[1] |  | Value of the minimum on the delta chi2 surface for the stellar radial velocity determinination step in apMADGICS |
 | DIB_pixoff_final_4_15672 | float64[1] | pixels | DIB pixel offset at optimum for DIB model 4_15672 |
 | RA | float64[1] | deg | Right ascension (J2000) |
 | DR17_X_H | float32[1] | dex | X_H ("metallicity") from ASPCAP allStar file for DR17 |
 | GY | float64[1] | kpc | Galactocentric cartesian Y-coordinate |
 | tot_p5chi2_v1_3_15672 | float64[1] |  | Total chi2 for the MADGICS model after including the DIB model 3_15672 |
 | tot_p5chi2_v1_4_15672 | float64[1] |  | Total chi2 for the MADGICS model after including the DIB model 4_15672 |
 | DIB_minchi2_final_4_15672 | float64[1] |  | minimum value of the delta chi2 at the optimum for adding DIB model 4_15672 to the MADGICS model for the visit spectrum |
 | mskDIB | bool[1] |  | Boolean mask identifying stars that are well enough modeled that the DIB model 2_15273 outputs can be trusted. A DIB "detection" still requires a cut(s) on dib_snr and/or EW_dib. |
 | DIB_v_LSR | float64[1] | km/s | DIB radial velocity in the local standard of rest for DIB model 2_15273 |
 | GLON | float64[1] | deg | Galactic longitude |
 | zcorr | float64[1] |  | Redshift correction to move from observed redshift to redshift relative to the solar system barycenter |
 | RV_bary | float64[1] | km/s | Stellar radial velocity from apMADGICS in the frame of the solar system barycenter (should be used with STAR_PRIOR_TYPE=th) |
 | EW_dib_err_4_15672 | float64[1] | Å | Uncertainty in DIB equivalent width for DIB model 4_15672 |
 | RV_flag | int64[1] |  | Grid search flag value from apMADGICS from the search for stellar radial velocity. See https://github.com/andrew-saydjari/apMADGICS.jl for bit interpretations. |
 | map2star | int64[1] |  | Index mapping the standard DRP allStar file to the ordering of this file. CAUTION 1-indexed (not 0-indexed) |
 | DIB_verr | float64[1] | km/s | Calibrated uncertainty on DIB radial velocity from DIB model 2_15273 |
 | GZ | float64[1] | kpc | Galactocentric cartesian Z-coordinate |
 | EW_dib_4_15672 | float64[1] | Å | Equivalent width of DIB in the 4_15672 DIB model |
 | EW_dib_err | float64[1] | Å | Calibrated uncertainty in DIB equivalent width for DIB model 2_15273 |
 | FIELD | char[19] |  | APOGEE targeting field name |
 | DIB_flag_4_15672 | int64[1] |  | Flag describing the success/failure of gridsearch fiting DIB model 4_15672. See https://github.com/andrew-saydjari/apMADGICS.jl/tree/main for explaination of bit values. |
 | DIB_flag_3_15672 | int64[1] |  | Flag describing the success/failure of gridsearch fiting DIB model 3_15672. See https://github.com/andrew-saydjari/apMADGICS.jl/tree/main for explaination of bit values. |
 | DIB_sigval_disc_final_4_15672 | float64[1] | Å | Discrete DIB width sigma value (on gridpoint) at optimum for DIB model 4_15672 |
 | DIB_pixoff_disc_final_2_15273 | float64[1] | pixels | DIB discrete pixel offset at optimum for DIB model 2_15273 |
 | FIBERID | int16[1] |  | APOGEE FIBERID used to obtain the visit spectrum (1 to 300 at each of APO and LCO) |
 | DIB_v_bary | float64[1] | km/s | DIB radial velocity with respect to the solar system barycenter for DIB model 15273 |
 | DIBchi2_residuals_4_15672 | float64[1] |  | Chi2 of the residual component after fitting DIB model 4_15672 |
 | DIB_sigval_disc_final_1_15273 | float64[1] | Å | Discrete DIB width sigma value (on gridpoint) at optimum for DIB model 1_15273 |
 | starscale | float64[1] | ADU | First pass median star flux in apMADGICS star continuum component model of the visit |
 | EW_dib_err_2_15273 | float64[1] | Å | Uncertainty in DIB equivalent width for DIB model 2_15273 |
 | skyscale0 | float64[1] | ADU | First pass median sky flux in apMADGICS sky component model of the visit |
 | RV_pix_var | float64[1] | pixels | Stellar radial velocity uncertainty expressed as a variance in the pixel offset (should be used with STAR_PRIOR_TYPE=th) |
 | DIB_pixoff_final_2_15273 | float64[1] | pixels | DIB pixel offset at optimum for DIB model 2_15273 |
 | DIB_sigval_final_1_15273 | float64[1] | Å | DIB width sigma value at optimum for DIB model 1_15273 |
 | TELESCOPE | char[6] |  | Telescope used for the visit (either apo25m or lco25m for the 2.5 meters at APO or LCO) |
 | MJD | int32[1] |  | Integer MJD (actually SJD, a SDSS construct) encoding the discretized "night" data was taken |
 | chip_a_midtimes | float64[1] | s | Best approximation to midpoint in time for exposures used in the visit for chip a |
 | chip_c_midtimes | float64[1] | s | Best approximation to midpoint in time for exposures used in the visit for chip c |
 | DRP_VHELIO | float64[1] | km/s | Heliocentric (actually barycentric) stellar radial velocity from the standard DRP |
 | GAIAEDR3_PARALLAX | float32[1] | mas | Gaia parallax from Gaia EDR3 |
 | GAIAEDR3_R_LO_GEO | float32[1] | pc | Gaia Bailer-Jones 16th GEO percentile distance r_lo from GAIA EDR3 |
 | chip_b_midtimes | float64[1] | s | Best approximation to midpoint in time for exposures used in the visit for chip b |
 | DIB_pixoff_disc_final_1_15273 | float64[1] | pixels | DIB discrete pixel offset at optimum for DIB model 1_15273 |
 | DIB_v_rel | float64[1] | km/s | DIB radial velocity in observed frame (for model 2_15273) |
 | GAIAEDR3_R_HI_GEO | float32[1] | pc | Gaia Bailer-Jones 84th GEO percentile distance r_hi from GAIA EDR3 |
 | DIB_sigval_final_4_15672 | float64[1] | Å | DIB width sigma value at optimum for DIB model 4_15672 |
 | APOGEE_ID | char[19] |  | Star identifier used by APOGEE (generally 2MASS) |
 | avg_flux_conservation | float64[1] |  | Median fractional flux conservation of MADGICS component separation across the visit spectrum |
 | DIB_flag_2_15273 | int64[1] |  | Flag describing the success/failure of gridsearch fiting DIB model 2_15273. See https://github.com/andrew-saydjari/apMADGICS.jl/tree/main for explaination of bit values. |
 | RV_verr_sys | float64[1] | km/s | Stellar radial velocity error with systematic corrections for apMADGICS RVs (should be used with STAR_PRIOR_TYPE=th) |
 | DR17_TEFF | float32[1] | K | TEFF from ASPCAP allStar file for DR17 |
 | final_pix_cnt | int64[1] |  | Final number of unmasked pixels used for modeling the visit spectrum |
 | cartVisit | int64[1] |  | Cart identifier for plate cart used during the visit observation (variations in total throughput can depend on the throughput of the fibers in a given cart) |



---
## Notes
None

---
## Regrets
I  have no regrets!