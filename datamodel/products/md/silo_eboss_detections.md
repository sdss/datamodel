# Data Model: silo_eboss_detections


Datamodel for silo_eboss_detections


## Contents
- [Basic Information](#basic-information)
- [Changelog](#changelog)
- [Example HDUS List](#example-hdus-list)
- [Notes](#notes)

---

## Basic Information
This catalog contains the detection information, emission-line analysis, and inspection information of strong galaxy-galaxy gravitational lens candidates that are spectroscopically detected by the Spectroscopic Identification of Lensing Objects (SILO) program (Talbot et al., in prep, which method is based upon the <a href="https://arxiv.org/abs/astro-ph/0511453">SLACS</a> and <a href="https://arxiv.org/abs/1112.3683">BELLS</a> surveys) within the 2 million galaxy spectra from the BOSS and eBOSS surveys.<br/><br/>The data contained in this catalog is split into three sections:<br/>   1. General catalog information and the emission-lines searched.<br/>   2. Detection information, model of the foreground galaxy, foreground subtracted spectra, original and re-scaled inverse-variance of the spectra, Gaussian convolved signal-to-noise of the foreground subtracted spectra, sky information, and bitmask information from the BOSS or eBOSS survey.<br/>   3. Gaussian modeling information and data from section 2 for each candidate background emission-line with sufficient signal to model.<br/><br/>Each candidate is assigned a grade that reflects the clarity of signal displayed. Each grade can be assigned with a +/- to better indicate if the candidate signal demonstrates more or less than the assurance required by the criteria of each grade. The grading criteria is designed to reflect a level of assurance as listed here:<br/>   Grade-A:  The candidate is likely a background galaxy and lensed.<br/>   Grade-B:  The candidate is probably a background galaxy and lensed.<br/>   Grade-C:  The candidate is possibly a background galaxy and lensed.<br/><br/>Plots of the candidate emission-lines that passed our S/N threshold can be accessed from the images folder: images/[PLATE]/flux-[PLATE]-[MJD]-[FIBERID]-[CATALOG_ID].png.<br/><br/>This catalog also includes 5" and 20" cutouts of low-resolution images of the targets to enable ease of observation of any indications of lensing. These images are accessed through the DESI Legacy Survey Sky Viewer (<a href="“http://legacysurvey.org/”">DESI Legacy Survey Sky Viewer</a>) from the SDSS Legacy Survey, DeCam Legacy Survey, and the combined images from the Mayall z-band Legacy Survey and Beijing-Arizona Sky Survey, which are presented in the images folder: images/[IMAGE_TYPE = (sdss_image, decals_image-dr7, mzls+bass_image-dr6)]-[PLATE]-[MJD]-[FIBERID]-[SIZE].png of the SDSS target.<br/>

### Naming Convention
<code>silo_eboss_detections-[SILO_VER].fits</code>

### Releases
DR16, DR17

### Enviroments
EBOSS_SPECTRO_LENSING

### Approximate Size
308 MB

### File Type
FITS

### Generated by Product
SILO 1.0.1 <em></em>

### Is a VAC
True

### HDUS List for release DR17
  - [HDU0: PRIMARY](#hdu0-primary)
  - [HDU1: DETECTIONS](#hdu1-detections)
  - [HDU2: EMISSION_LINE_ANALYSIS](#hdu2-emission_line_analysis)

---

## Changelog
Describes changes to the datamodel product and/or file structure from one release to another
 - DR17
   - from: DR16
   - note: No changes

---
## Example HDUS List

### HDU0: PRIMARY
Empty except for global header

#### HDU Type: IMAGE
#### HDU Size:  0 bytes

##### Header Table Caption for HDU0
Key | Value | Comment | |
| --- | --- | --- | --- |
| SIMPLE | True | conforms to FITS standard |
| BITPIX | 8 | array data type |
| NAXIS | 0 | number of array dimensions |
| EXTEND | True |  |
| PROJECT | SILO | Lens search project |
| AUTHORS | M. Talbot, J. Brownstein | SILO project creators |
| INSP | Michael Talbot | Detection inspector |
| SCANNED | BOSS+eBOSS | SDSS surveys scanned by SILO |
| SILO_VER | 1.0.1 | Version of SILO project used |
| RUN1D | V5_13_0 | BOSS/eBOSS 1D reduction version of spectra |
| RUN2D | V5_13_0 | BOSS/eBOSS 2D reduction version of spectra |
| RELEASE | DR16 | SDSS data release version |
| SAMPLING | LOG | Wavelength sampling of spectra |
| SPECTYPE | COADDED | Type of spectra searched |
| OIIB | 3727.092 | Restframe wavelength of OIIb |
| OIIA | 3729.875 | Restframe wavelength of OIIa |
| HID | 4102.892 | Restframe wavelength of HId |
| HIC | 4341.684 | Restframe wavelength of HIc |
| HIB | 4862.683 | Restframe wavelength of HIb |
| OIIIB | 4960.295 | Restframe wavelength of OIIIb |
| OIIIA | 5008.239 | Restframe wavelength of OIIIa |
| NIIB | 6549.86 | Restframe wavelength of NIIb |
| HIA | 6564.614 | Restframe wavelength of HIa |
| NIIA | 6585.27 | Restframe wavelength of NIIa |
| SIIB | 6718.29 | Restframe wavelength of SIIb |
| SIIA | 6732.68 | Restframe wavelength of SIIa |



### HDU1: DETECTIONS
Columns of table contains target information, spectra data, foregound model, detection information, and inspection grade and comments.

#### HDU Type: BINARY TABLE
#### HDU Size:  305 MB

##### Header Table Caption for HDU1
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | BINTABLE | binary table extension |
| BITPIX | 8 | array data type |
| NAXIS | 2 | number of array dimensions |
| NAXIS1 | 3386 | length of dimension 1 |
| NAXIS2 | 1551 | length of dimension 2 |
| PCOUNT | 314832276 | number of group parameters |
| GCOUNT | 1 | number of groups |
| TFIELDS | 39 | number of table fields |
| TUNIT25 | Degree |  |
| TUNIT26 | Degree |  |
| TUNIT27 | hour:':'' |  |
| TUNIT28 | Degree:':'' |  |
| TUNIT29 | Angstroms |  |
| TUNIT30 | 10^-17 ergs/s/cm^2/Ang |  |
| TUNIT34 | 10^-17 ergs/s/cm^2/Ang |  |
| TUNIT35 | pixel=dloglam |  |
| TUNIT36 | 10^-17 ergs/s/cm^2/Ang |  |
| TUNIT38 | 10^-17 ergs/s/cm^2/Ang |  |
| EXTNAME | DETECTIONS | extension name |

##### Binary Table Caption for HDU1
Name | Type | Unit | Description |
| --- | --- | --- | --- |
 | CATALOG_ID | int32 |  | Detection identifier for this catalog |
 | EMLINE_SCAN_TYPE | char[10] |  | Single-line=OII(b, a), Multi-line=2+ lines |
 | DETECTION_Z | float32 |  | Redshift of background candidate |
 | N_EMLINES_SN_GE4 | int32 |  | Number of emission-lines detected with SN>=4 |
 | QUADATURE_SUM_SN_GE3 | float32 |  | Quadrature sum of emission-lines with SN>=3 |
 | SPECTRA_GRADE | char[2] |  | Grade of spectra assurances of source candidate |
 | TOTAL_GRADE | char[2] |  | Grade of spectra+image assurances of candidate |
 | COMMENT | char[3000] |  | Comment of assuring/non-assuring features |
 | FIRST_DETECTION_FROM | char[30] |  | Identity of earlier discoverer |
 | FIRST_DETECTION_LG | char[20] |  | Strong lens grade from Masterlens database |
 | SDSS_TARGET_NAME | char[20] |  | SDSS RA+DEC name of target |
 | PLATE | int32 |  | Plate of BOSS/eBOSS observation of target |
 | MJD | int32 |  | Modified Julian Date on observation of target |
 | FIBER_INDEX | int32 |  | Fiber on plate used for observation |
 | SDSS_SURVEY | char[10] |  | SDSS survey the spectra was obtained from |
 | BESTOBJID | char[30] |  | SDSS best object id for target |
 | SPECOBJID | char[30] |  | SDSS spectroscopic object id for target |
 | CLASS_NOQSO | char[10] |  | SDSS non-quasar classification of target |
 | OBJCLASS | char[15] |  | SDSS classification of target |
 | TARGET_GALAXY_TYPE | char[15] |  | SDSS classification of type of target galaxy |
 | TARGETOBJID | char[30] |  | SDSS target object id |
 | Z_NOQSO | float32 |  | SDSS no-quasar evaluation of target redshift |
 | ZERR_NOQSO | float32 |  | SDSS no-quasar error of redshift |
 | ZWARNING_NOQSO | int32 |  | SDSS redshift measurement warning |
 | RA | float32 | Degree | Target right ascension |
 | DEC | float32 | Degree | Target declination |
 | RA_HMS | char[13] | hour:':'' | Target right ascension in hour:min:sec |
 | DEC_DMS | char[13] | Degree:':'' | Target declination in degree:min:sec |
 | WAVE | float32[PE(4646] | Angstroms | Wavelength vector of spectra |
 | FLUX | float32[PE(4646] | 10^-17 ergs/s/cm^2/Ang | Coadded flux |
 | IVAR | float32[PE(4646] |  | Inverse varience of spectra |
 | AND_MASK | int32[PJ(4646] |  | and_mask of coadded spectra |
 | OR_MASK | int32[PJ(4646] |  | or_mask of coadded spectra |
 | SKY | float32[PE(4646] | 10^-17 ergs/s/cm^2/Ang | Coadded sky emissions |
 | WDISP | float32[PE(4646] | pixel=dloglam | Wavelength dispersion |
 | MODEL_SILO | float32[PE(4646] | 10^-17 ergs/s/cm^2/Ang | Foreground model generated by SILO |
 | IVAR_RESCALED | float32[PE(4646] |  | Rescaled inverse varience |
 | RESIDUAL_FLUX | float32[PE(4646] | 10^-17 ergs/s/cm^2/Ang | Residual flux of FLUX-MODEL_SILO |
 | SN_SPECTRA_SG | float32[PE(4646] |  | Gaussian convolved signal-to-noise of spectra |



### HDU2: EMISSION_LINE_ANALYSIS
This table contains information for each emission-line

#### HDU Type: BINARY TABLE
#### HDU Size:  2 MB

##### Header Table Caption for HDU2
Key | Value | Comment | |
| --- | --- | --- | --- |
| XTENSION | BINTABLE | binary table extension |
| BITPIX | 8 | array data type |
| NAXIS | 2 | number of array dimensions |
| NAXIS1 | 159 | length of dimension 1 |
| NAXIS2 | 7637 | length of dimension 2 |
| PCOUNT | 1795296 | number of group parameters |
| GCOUNT | 1 | number of groups |
| TFIELDS | 21 | number of table fields |
| TUNIT4 | Angstroms |  |
| TUNIT7 | Angstroms |  |
| TUNIT8 | Angstroms |  |
| TUNIT9 | Angstroms |  |
| TUNIT10 | Angstroms |  |
| TUNIT16 | Angstroms |  |
| TUNIT17 | 10^-17 ergs/s/cm^2/Ang |  |
| TUNIT18 | 10^-17 ergs/s/cm^2/Ang |  |
| EXTNAME | EMISSION_LINE_ANALYSIS | extension name |

##### Binary Table Caption for HDU2
Name | Type | Unit | Description |
| --- | --- | --- | --- |
 | DETECTION_CATALOG_ID | int32 |  | Detection identifier for this catalog |
 | NAME | char[30] |  | Name of emission-line |
 | INDEX_IN_SPECTRA | int32 |  | Index emission-line is located in spectra |
 | EM_WAVE | float32 | Angstroms | Observed-frame wavelength of emission-line |
 | SN | float32 |  | Convolved signal-to-noise of emission-line |
 | GAUSS_FIT_REPORTED | bool |  | Gauss fit reported if SN>=3 |
 | GAUSS_WAVE | float32[PE(4] | Angstroms | Wavelength(s) center of model w. -/+97.5 Q. |
 | GAUSS_BASE_HEIGHT | float32[3] | Angstroms | Gaussian model base height w. -/+97.5 Q. |
 | GAUSS_AMPLITUDE | float32[3] | Angstroms | Gaussian model amplitude w. -/+97.5 Q. |
 | GAUSS_SIGMA | float32[3] | Angstroms | Gaussian model sigma w. -/+97.5 Q. |
 | RCHI2_SAMPLE | float32 |  | Reduced chi^2 of Gauss fit to sample |
 | NDOF_SAMPLE | int32 |  | Degree of freedom of RCHI2_SAMPLE |
 | RCHI2_3SIG | float32 |  | Reduced chi^2 of Gauss fit within 3 sigma |
 | NDOF_3SIG | int32 |  | Degree of freedom of RCHI2_3SIG |
 | SAMPLE_SIZE | int32 |  | Sample size |
 | MODEL_WAVE_BASE | float32[PE(21] | Angstroms | Wavelength base of Gaussian model |
 | GAUSS_MODEL | float32[PE(21] | 10^-17 ergs/s/cm^2/Ang | Gaussian model of residual flux |
 | FITTED_RESIDUAL_FLUX | float32[PE(21] | 10^-17 ergs/s/cm^2/Ang | Residual flux segment used in Gaussian fit |
 | FITTED_IVAR_RESCALED | float32[PE(21] |  | Rescaled inverse varience used in Gauss fit |
 | AND_MASK | int32[PJ(21] |  | SDSS AND_MASK of spectra sample |
 | OR_MASK | int32[PJ(21] |  | SDSS OR_MASK of spectra sample |



---
## Notes

Examples
How to use python to find and select data for a specific detection

        import numpy as np
        from astropy.io import fits
        
        #How about we exame a candidate that was confirmed by the BELLS survey
        plate = 3861 #BOSS plate of the observation
        mjd = 55274 #Modified julian day of observation
        fiberid = 393 #Index of fiber on plate used to observe target
        
        hdu = fits.open('Your path to/v5_13_0/v5_13_0/1.0.1/silo_eboss_detections-1.0.1.fits')
        index = np.where((hdu['DETECTIONS'].data['PLATE'] == plate)
            & (hdu['DETECTIONS'].data['MJD'] == mjd)
            & (hdu['DETECTIONS'].data['FIBER_INDEX'] == fiberid))[0][0]
            
        data_for_plate_mjd_fiberid = hdu['DETECTIONS'].data[index]
        
        #Now how about we get data for an emission line, such as the spectra for the OII(b,a) Doublet
        index_for_plate_mjd_fiberid = 
		np.where((hdu['EMISSION_LINE_ANALYSIS'].data['DETECTION_CATALOG_ID'] == data_for_plate_mjd_fiberid['CATALOG_ID'])
		& (hdu['EMISSION_LINE_ANALYSIS'].data['NAME'] == 'OII(b, a) doublet'))[0][0]
             
        emline_for_plate_mjd_fiberid = hdu['EMISSION_LINE_ANALYSIS'].data[index_for_plate_mjd_fiberid]
        
        #What is the signal to noise measured for this emission-line
        print('SN =',emline_for_plate_mjd_fiberid['SN'])
        
        # Lets pull out the detection redshift and the residual flux
        z = data_for_plate_mjd_fiberid['DETECTION_Z']
        wave_vector = data_for_plate_mjd_fiberid['WAVE']
        residual_flux = data_for_plate_mjd_fiberid['RESIDUAL_FLUX']
        
        # Lets prepare to view the OII(b,a) doublet in pyplot
        import matplotlib.pyplot as plt
        
        # How to find an index of an emission line in the spectra
        observed_wavelength = np.sqrt(hdu[0].header['OIIB']*hdu[0].header['OIIA']) * (1+z)
        window = 10
        emline_index = np.abs(wave_vector - observed_wavelength).argmin()
       
        #OR !!!!
        #emline_index = emline_for_plate_mjd_fiberid['INDEX_IN_SPECTRA']
        
        #Now lets plot the flux-model spectra at the position of the OII(b,a) doublet
        plt.plot(wave_vector[emline_index-10:emline_index+10], residual_flux[emline_index-10:emline_index+10], 'k')
        #OR if emline_for_plate_mjd_fiberid['GAUSS_FIT_REPORTED'] is True you can plot the flux-model with Gauss model
	#plt.plot(emline_for_plate_mjd_fiberid['MODEL_WAVE_BASE'], emline_for_plate_mjd_fiberid['FITTED_RESIDUAL_FLUX'],'k',
	    emline_for_plate_mjd_fiberid['MODEL_WAVE_BASE'], emline_for_plate_mjd_fiberid['GAUSS_MODEL'], 'g--') 
        plt.xlabel('Wavelength (Angstroms)')
        plt.ylabel('Flux 10^-17 erg/s/cm^2/Ang')
        plt.show(block=False)
        
        #You can look at the target image by browsing through the images folder for
			...image/[PLATE]/[IMAGE_TYPE]-[PLATE]-[MJD]-[FIBERID]-[SIZE].png
            #where:
            PLATE = data_for_plate_mjd_fiberid['PLATE']
            MJD = data_for_plate_mjd_fiberid['MJD']    
            FIBERID = data_for_plate_mjd_fiberid['FIBER_INDEX']
            IMAGE_TYPE = (sdss, decals_image-dr7, mzls+bass_image-dr6)
            SIZE = 20 #Options are: 5", 20"

        #You can also look at plots of the candidate emission-lines with the
			grade and comment included in the images folder for
			...image/[PLATE]/flux-[PLATE]-[MJD]-[FIBERID]-[CATALOG_ID].png
            #where:
            PLATE = data_for_plate_mjd_fiberid['PLATE']
            MJD = data_for_plate_mjd_fiberid['MJD']
            FIBERID = data_for_plate_mjd_fiberid['FIBER_INDEX']
            CATALOG_ID = data_for_plate_mjd_fiberid['CATALOG_ID']
        
