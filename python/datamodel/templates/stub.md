<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html" charset="utf-8">
        <title>Data Model: {{name}}</title>
        <link rel="stylesheet" href="/datamodel/datamodel.css" type="text/css" />
        <link rel="icon" href="/datamodel/sdss.ico" type="image/x-icon" />
        <link rel="shortcut icon" href="/datamodel/sdss.ico" type="image/x-icon" />
    </head>
    <body>

    <div id="intro">
        <h1>Data Model: {{name}}</h1>
        <dl>
        <dt>General Description</dt>
        <dd>
        This file is the template data model file. It is meant as a guideline
        to how to write each data model file.  The main categories (in bold)
        should be respected, but extra information can be included as
        appropriate.  The example sections below are primarily related to FITS files.
        </dd>

        <dt>Naming Convention</dt>
        <dd id="filename"><code>{{filename}}</code>, Replace this filename with a
        regular expression that matches the file name.  For example, a six-digit number would
        correspond to <code>[0-9]{6}</code>.  <code>template-123456.fits</code>
        would be <code>template-[0-9]{6}\.fits</code></dd>

        <dt>Approximate Size</dt>
        <dd id="filesize">{{filesize}}</dd>

        <dt>File Type</dt>
        <dd id="filetype">{{filetype}}</dd>

        <dt>Generated by Product</dt>
        <dd>sas <em>(can be any set of product names)</em></dd>

        <dt id="sections">Sections</dt>
        <dd><p>This should contain internal links to parts of the file (if any).</p>
            <ul>
                {% for hdu in hdus %}
                <li><a href="#hdu{{loop.index0}}">HDU{{loop.index0}}: {{hdu.name}}</a></li>
                {% endfor %}
                <li><a href="#example">Examples</a></li>
            </ul>
        </dd>
        </dl>
    </div>

    <div id="examplehdu">
        <h2>Example HDU Template: Delete This</h2>
        <h3>Introduction</h3>
        <p>This section should contain any information related to the primary
        header. Keywords are listed in the table below.  There are three types
        of values for keywords:</p>
        <dl>
            <dt>Explicit Values</dt>
            <dd>The keyword <em>must</em> be present and <em>must</em> have the value given in the table.</dd>
            <dt>Allowed Values</dt>
            <dd>The keyword <em>must</em> be present and <em>must</em> conform to the regular expression given in the table. That is, the keyword may have a range of possible values.</dd>
            <dt>Checked Values</dt>
            <dd>The keyword <em>must</em> be present but may have any value as long as it is the correct type.</dd>
        </dl>
        <p>If a keyword might not be present in a FITS file, it should not be listed in
        this table, but a note should be made in the datamodel file.</p>
        <h3>Header in HDU</h3>
        <table>
        <caption>Required Header Keywords</caption>
        <thead id="headexample">
            <tr><th>Key</th><th>Value</th><th>Type</th><th>Comment</th></tr>
        </thead>
        <tbody id="bodyexample">
            <tr><td>SIMPLE</td><td>T</td><td>bool</td><td>Conforms to FITS standard. This is a good example of an explicit value.</td></tr>
            <tr><td>BITPIX</td><td>-32</td><td>int</td><td>32 bit floating point. This is another good example of an explicit value.</td></tr>
            <tr><td>NAXIS</td><td>2</td><td>int</td><td>Example explicit value.</td></tr>
            <tr><td>NAXIS1</td><td>2048</td><td>int</td><td>Example explicit value.</td></tr>
            <tr><td>NAXIS2</td><td>1489</td><td>int</td><td>Example explicit value.</td></tr>
            <tr><td>EXTEND</td><td>T</td><td>bool</td><td>Extensions may be present.  Example explicit value.</td></tr>
        </tbody>
        </table>
        <h3>Optional Binary Table in HDU</h3>
        <table>
        <caption>Required Header Keywords</caption>
        <thead id="binheadexample">
            <tr><th>Name</th><th>Type</th><th>Unit</th><th>Description</th></tr>
        </thead>
        <tbody id="binbodyexample">
            <tr><td></td><td></td><td></td><td></td></tr>
        </tbody>
        </table>
    </div>
    {% set type = "Not Implemented" %}
    {% for hdu in hdus %}
    <div id="hdu{{loop.index0}}">
        <h2>HDU{{loop.index0}}: {{hdu.name}}</h2>
        <p>[Summarize contents of this HDU]</p>
        <dl>
        <dt>HDU Type</dt><dd>{{'IMAGE' if hdu.is_image else 'BINARY TABLE'}}</dd>
        <dt>HDU Size</dt><dd>{{hdu.size|getHDUSize}}</dd>
        </dl>
        {% set hdr = hdu.header %}

        {# IMAGE HDUS #}
        <table>
            <caption>Header Table Caption for HDU{{loop.index0}}</caption>
            <thead id="head{{loop.index0}}">
                <tr><th>Key</th><th>Value</th><th>Type</th><th>Comment</th></tr>
            </thead>
             <tbody id="body{{loop.index0}}">
                {% for key, value in hdr.items() %}
                    {% if key|isKeyAColumn %}
                    <tr><td>{{key}}</td><td>{{value}}</td><td>{{type}}</td><td>{{hdr.comments[key]}}</td></tr>
                    {% endif %}
                {% endfor %}
             </tbody>
        </table>

        {# BINARY TABLE HDUS #}
        {% if not hdu.is_image %}
        <table>
            <caption>Binary Table Caption for HDU{{loop.index0}}</caption>
            <thead id="binhead{{loop.index0}}">
                <tr><th>Name</th><th>Type</th><th>Unit</th><th>Description</th></tr>
            </thead>
             <tbody id="binbody{{loop.index0}}">
                {% for row in hdu.columns %}
                    <tr><td>{{row.name|upper}}</td><td>{{row.format|getType}}</td><td>Not Implemented</td><td></td></tr>
                {% endfor %}
             </tbody>
        </table>
        {% endif %}
    </div>
    {% endfor %}

    <div id="example">
        <h2>Examples</h2>
        <p>This section is the place to put examples of use and other comments.
        You may also add example files to the datamodel and link to them here.</p>
        <p><a href="template.html">Example File</a></p>
    </div>

    </body>
</html>
